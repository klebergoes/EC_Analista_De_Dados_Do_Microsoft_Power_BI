# Projeto de Exploração de Conceitos - Analista de Dados do Microsoft Power BI

## Sumário

[1. Introdução à análise de dados da Microsoft](#Introdução-à-análise-de-dados-da-Microsoft)

&nbsp;&nbsp;&nbsp;&nbsp; [1.1. Descobrir a análise de dados](#Descobrir-a-análise-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.1. Visão geral da análise de dados](#Visão-geral-da-análise-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.1.1. Análise descritiva](#Análise-descritiva)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.1.2. Análise diagnóstica](#Análise-diagnóstica)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.1.3. Análise preditiva](#Análise-preditiva)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.1.4. Análise prescritiva](#Análise-prescritivas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.1.5. Análise cognitiva](#Análise-cognitiva)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.2. Funções em dados](#Funções-em-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.2.1. Analista de negócios](#Analista-de-negócios)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.2.2. Analista de dados](#Analista-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.2.3. Engenheiro de dados](#Engenheiro-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.2.4. Cientista de dados](#Cientista-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.2.5. Administrador de banco de dados](#Administrador-de-banco-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.3. Tarefas de um analista de dados](#Tarefas-de-um-analista-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.3.1. Preparar](#Preparar)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.3.2. Modelar](#Modelar)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.3.3. Visualizar](#Visualizar)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.3.4. Analisar](#Analisar)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.1.3.5. Gerenciar](#Gerenciar)

&nbsp;&nbsp;&nbsp;&nbsp; [1.2. Comece a criar com o Power BI](#Comece-a-criar-com-o-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.1. Usando o Power BI](#Usando-o-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.2. Explore o fluxo do Power BI](#Explore-o-fluxo-do-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.3. Blocos de construção do Power BI](#Blocos-de-construção-do-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.3.1. Crie um modelo semântico](#Crie-um-modelo-semântico)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.3.2. Crie visualizações em um relatório](#Crie-visualizações-em-um-relatório)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.3.3. Crie um painel](#Crie-um-painel)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.4. Tour e uso do Power BI Service](#Tour-e-uso-do-Power-BI-Service)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.4.1. Workspaces](#Workspaces)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.4.2. Seção Aprender](#Seção-Aprender)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.4.3. Seção Aplicativos](#Seção-Aplicativos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.2.4.4. Atualizar um modelo semântico](#Atualizar-um-modelo-semântico)

&nbsp;&nbsp;&nbsp;&nbsp; [1.3. Introdução à análise de ponta a ponta usando o Microsoft Fabric](#Introdução-à-análise-de-ponta-a-ponta-usando-o-Microsoft-Fabric)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.1. Explorar análises de ponta a ponta com o Microsoft Fabric](#Explorar-análises-de-ponta-a-ponta-com-o-Microsoft-Fabric)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.1.1. OneLake](#OneLake)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.1.2. Workspace](#Workspace)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.1.3. Administração e governança](#Administração-e-governança)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.2. Explorar as equipes de dados e o Microsoft Fabric](#Explorar-as-equipes-de-dados-e-o-Microsoft-Fabric)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.2.1. Funções e desafios tradicionais](#Funções-e-desafios-tradicionais)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.2.1. Evolução dos fluxos de trabalho colaborativos](#Evolução-dos-fluxos-de-trabalho-colaborativos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.3. Habilitar e usar o Microsoft Fabric](#Habilitar-e-usar-o-Microsoft-Fabric)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.3.1. Habilitar o Microsoft Fabric](#Habilitar-o-Microsoft-Fabric)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.3.2. Criar workspace](#Criar-workspace)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.3.3. Descobrir dados com o catálogo do OneLake](#Descobrir-dados-com-o-catálogo-do-OneLake)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.3.3.4. Criar itens utilizando as cargas de trabalho do Fabric](#Criar-itens-utilizando-as-cargas-de-trabalho-do-Fabric)

&nbsp;&nbsp;&nbsp;&nbsp; [1.4. Criar relatórios interativos usando o Copilot para Power BI](#Criar-relatórios-interativos-usando-o-Copilot-para-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.1. Prepare seus dados para uso com o Copilot para Power BI](#Prepare-seus-dados-para-uso-com-o-Copilot-para-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.1.1. Garantir a qualidade dos dados](#Garantir-a-qualidade-dos-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.1.2. Preparar dados com o Power Query](#Preparar-dados-com-o-Power-Query)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.2. Use o Copilot para Power BI para modelar seus dados](#Use-o-Copilot-para-Power-BI-para-modelar-seus-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.2.1. Conectar tabelas com relacionamentos](#Conectar-tabelas-com-relacionamentos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.2.2. Criar medidas rápidas](#Criar-medidas-rápidas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.2.3. Consulta com DAX](#Consulta-com-DAX)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.2.4. Criar medidas a partir de consultas DAX](#Criar-medidas-a-partir-de-consultas-DAX)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.3. Crie relatórios com o Copilot para Power BI](#Crie-relatórios-com-o-Copilot-para-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.3.1. Criar relatórios com o Power BI Desktop](#Criar-relatórios-com-o-Power-BI-Desktop)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.3.2. Criar relatórios com o Power BI Service](#Criar-relatórios-com-o-Power-BI-Service)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.3.3. Criar páginas com prompts personalizados](#Criar-página-com-prompts-personalizados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.3.4. Considerações finais](#Considerações-finais)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.4. Criar resumos com o Copilot para Power BI](#Criar-resumos-com-o-Copilot-para-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.4.1. Resumir com o visual Narrativa](#Resumir-com-o-visual-Narrativa)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1.4.4.2. Resumir no painel do Copilot](#Resumir-no-painel-do-Copilot)

[2. Preparar dados para análise com o Power BI](#Preparar-dados-para-análise-com-o-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp; [2.1. Obter dados no Power BI](#Obter-dados-no-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.1. Obter dados de arquivos](#Obter-dados-de-arquivos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.1.1. Localização do arquivo simples](#Localização-do-arquivo-simples)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.1.2. Conectar-se aos dados em um arquivo](#Conectar-se-aos-dados-em-um-arquivo)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.1.3. Selecionar os dados do arquivo a serem importados](#Selecionar-os-dados-do-arquivo-a-serem-importados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.1.4. Alterar o arquivo de origem](#Alterar-o-arquivo-de-origem)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.2. Obter dados de fontes de dados relacionais](#Obter-dados-de-fontes-de-dados-relacionais)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.2.1. Conectar-se a dados em um banco de dados relacional](#Conectar-se-a-dados-em-um-banco-de-dados-relacional)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.2.2. Selecionar dados para importar](#Selecionar-dados-para-importar)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.2.3. Importar dados escrevendo uma consulta SQL](#Importar-dados-escrevendo-uma-consulta-SQL)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.2.4. Alterar configurações da fonte de dados](#Alterar-configurações-da-fonte-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.2.5. Escrever uma instrução SQL](#Escrever-uma-instrução-SQL)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.3. Criar relatórios dinâmicos com parâmetros](#Criar-relatórios-dinâmicos-com-parâmetros)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.3.1. Criar relatórios dinâmicos para valores individuais](#Criar-relatórios-dinâmicos-para-valores-individuais)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.3.2. Criar relatórios dinâmicos para vários valores](#Criar-relatórios-dinâmicos-para-vários-valores)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.4. Obter dados de um banco de dados NoSQL](#Obter-dados-de-um-banco-de-dados-NoSQL)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.4.1. Conectar-se a um banco de dados NoSQL (Azure Cosmos DB)](#Conectar-se-a-um-banco-de-dados-NoSQL-(Azure-Cosmos-DB))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.4.2. Importar um arquivo JSON](#Importar-um-arquivo-JSON)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.5. Obter dados de serviços online](#Obter-dados-de-serviços-online)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.5.1. Conectar-se a dados em um aplicativo](#Conectar-se-a-dados-em-um-aplicativo)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.5.2. Escolher os dados do aplicativo a serem importados](#Escolher-os-dados-do-aplicativo-a-serem-importados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.6. Selecionar um modo de armazenamento](#Selecionar-um-modo-de-armazenamento)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.6.1. Modo Import](#Modo-Import)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.6.2. Modo DirectQuery](#Modo-DirectQuery)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.6.3. Modo Duplo (composto)](#Modo-Duplo-(composto))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.7. Obter dados do Azure Analysis Services](#Obter-dados-do-Azure-Analysis-Services)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.7.1. Conectar-se a dados no Azure Analysis Services](#Conectar-se-a-dados-no-Azure-Analysis-Services)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.8. Corrigir problemas de desempenho](#Corrigir-problemas-de-desempenho)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.8.1. Otimizar o desempenho no Power Query](#Otimizar-o-desempenho-no-Power-Query)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.8.2. Dobragem de consultas](#Dobragem-de-consultas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.8.3. Diagnóstico de consulta](#Diagnóstico-de-consulta)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.8.4. Outras técnicas para otimizar o desempenho](#Outras-técnicas-para-otimizar-o-desempenho)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.9. Resolver erros de importação de dados](#Resolver-erros-de-importação-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.9.1. O tempo limite da consulta expirou](#O-tempo-limite-da-consulta-expirou)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.9.2. Erro de Consulta do Power BI: O tempo limite expirou](#Erro-de-Consulta-do-Power-BI:-O-tempo-limite-expirou)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.9.3. Não foi possível localizar nenhum dado formatado como uma tabela](#Não-foi-possível-localizar-nenhum-dado-formatado-como-uma-tabela)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.9.4. Não foi possível encontrar o arquivo](#Não-foi-possível-encontrar-o-arquivo)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.1.9.5. Erros de tipo de dados](#Erros-de-tipo-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp; [2.2. Limpar, transformar e carregar dados no Power BI](#Limpar,-transformar-e-carregar-dados-no-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1. Formatar os dados iniciais](#Formatar-os-dados-iniciais)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.1. Introdução ao Editor do Power Query](#Introdução-ao-Editor-do-Power-Query)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.2. Identificar cabeçalhos e nomes de colunas](#Identificar-cabeçalhos-e-nomes-de-colunas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.3. Promover cabeçalhos](#Promover-cabeçalhos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.4. Renomear colunas](#Renomear-colunas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.5. Remover linhas superiores](#Remover-linhas-superiores)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.6. Remover colunas](#Remover-colunas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.7. Transformar colunas em linhas](#Transformar-colunas-em-linhas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.1.8. Dinamizar colunas](#Dinamizar-colunas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.2. Simplificar a estrutura de dados](#Simplificar-a-estrutura-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.2.1. Renomear uma consulta](#Renomear-uma-consulta)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.2.2. Substituir valores](#Substituir-valores)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.2.3. Substituir valores nulos](#Substituir-valores-nulos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.2.4. Remover duplicatas](#Remover-duplicatas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.2.5. Práticas recomendadas para nomear tabelas, colunas e valores](#Práticas-recomendadas-para-nomear-tabelas,-colunas-e-valores)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.3. Avaliar e alterar os tipos de dados da coluna](#Avaliar-e-alterar-os-tipos-de-dados-da-coluna)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.3.1. Implicações de tipos de dados incorretos](#Implicações-de-tipos-de-dados-incorretos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.3.2. Alterar o tipo de dados da coluna](#Alterar-o-tipo-de-dados-da-coluna)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.4. Combinar várias tabelas em uma só](#Combinar-várias-tabelas-em-uma-só)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.4.1. Acrescentar consultas](#Acrescentar-consultas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.4.2. Mesclar consultas](#Mesclar-consultas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.5. Criar o perfil de dados no Power BI](#Criar-o-perfil-de-dados-no-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.5.1. Examinar as estruturas de dados](#Examinar-as-estruturas-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.5.2. Localizar anomalias e estatísticas de dados](#Localizar-anomalias-e-estatísticas-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.2.6. Usar o Editor Avançado para modificar o código M](#Usar-o-Editor-Avançado-para-modificar-o-código-M)

&nbsp;&nbsp;&nbsp;&nbsp; [2.3. Escolher uma estrutura de modelo do Power BI](#Escolher-uma-estrutura-de-modelo-do-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1. Descrever conceitos básicos do modelo do Power BI](#Descrever-conceitos-básicos-do-modelo-do-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.1. Modelo de dados](#Modelo-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.2. Conjunto de dados do Power BI](#Conjunto-de-dados-do-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.3. Consulta analítica](#Consulta-analítica)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.4. Modelo de tabela](#Modelo-de-tabela)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.5. Design do esquema em estrela](#Design-do-esquema-em-estrela)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.6. Modo de armazenamento de tabela](#Modo-de-armazenamento-de-tabela)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.1.7. Estrutura do modelo](#Estrutura-do-modelo)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.2. Determinar quando desenvolver um modelo de importação](#Determinar-quando-desenvolver-um-modelo-de-importação)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.2.1. Benefícios do modelo de importação](#Benefícios-do-modelo-de-importação)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.2.2. Limitações do modelo de importação](#Limitações-do-modelo-de-importação)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.2.3. Tamanho do modelo](#Tamanho-do-modelo)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.2.4. Atualização de dados](#Atualização-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.3. Determinar quando desenvolver um modelo do DirectQuery](#Determinar-quando-desenvolver-um-modelo-do-DirectQuery)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.3.1. Benefícios do modelo DirectQuery](#Benefícios-do-modelo-DirectQuery)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.3.2. Limitações do modelo DirectQuery](#Limitações-do-modelo-DirectQuery)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.3.3. Aprimorar o desempenho do modelo DirectQuery](#Aprimorar-o-desempenho-do-modelo-DirectQuery)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.4. Determinar quando desenvolver um modelo composto](#Determinar-quando-desenvolver-um-modelo-composto)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.4.1. Benefícios do modelo composto](#Benefícios-do-modelo-composto)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.4.2. Limitações do modelo composto](#Limitações-do-modelo-composto)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.4.3. Aumentar o desempenho do modelo DirectQuery usando dados de importação](#Aumentar-o-desempenho-do-modelo-DirectQuery-usando-dados-de-importação)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.4.4. Fornecer dados em tempo real de um modelo de importação](#Fornecer-dados-em-tempo-real-de-um-modelo-de-importação)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2.3.5. Escolher uma estrutura de modelo](#Escolher-uma-estrutura-de-modelo)

[3. Modelar dados com o Power BI](#Modelar-dados-com-o-Power-BI)

&nbsp;&nbsp;&nbsp;&nbsp; [3.1. Configurar um modelo semântico](#Configurar-um-modelo-semântico)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1. Configurar relacionamentos](#Configurar-relacionamentos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1.1. Configurar opções de carregamento de dados](#Configurar-opções-de-carregamento-de-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1.2. Colunas](#Colunas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1.3. Noções básicas sobre cardinalidade](#Noções-básicas-sobre-cardinalidade)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1.4. Noções básicas sobre direção do filtro cruzado](#Noções-básicas-sobre-direção-do-filtro-cruzado)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1.5. Relacionamentos ativos x inativos](#Relacionamentos-ativos-x-inativos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.1.6. Trabalhar com o diagrama do modelo](#Trabalhar-com-o-diagrama-do-modelo)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.2. Configurar tabelas](#Configurar-tabelas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.2.1. Configurar propriedades de tabela](#Configurar-propriedades-de-tabela)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.2.2. Marcar tabelas de datas](#Marcar-tabelas-de-datas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.3. Configurar colunas](#Configurar-colunas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.3.1. Configurar formatação de coluna](#Configurar-formatação-de-coluna)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.3.2. Definir ordem de classificação](#Definir-ordem-de-classificação)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.3.3. Categorizar dados](#Categorizar-dados)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.3.4. Definir sumarização](#Definir-sumarização)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.4. Configurar hierarquias](#Configurar-hierarquias)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.5. Configurar medidas](#Configurar-medidas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.5.1. Usar medidas rápidas](#Usar-medidas-rápidas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.6. Configurar parâmetros](#Configurar-parâmetros)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.6.1. Criar um parâmetro de Intervalo numérico](#Criar-um-parâmetro-de-Intervalo-numérico)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.1.6.2. Criar um parâmetro de Campos](#Criar-um-parâmetro-de-Campos)

&nbsp;&nbsp;&nbsp;&nbsp; [3.2. Escrever fórmulas DAX para modelos semânticos](#Escrever-fórmulas-DAX-para-modelos-semânticos)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1. Noções básicas dos tipos de cálculo DAX](#Noções-básicas-dos-tipos-de-cálculo-DAX)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1.1. Tabelas calculadas](#Tabelas-calculadas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1.2. Tabelas de datas](#Tabelas-de-datas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1.3. Dimensões com função múltipla](#Dimensões-com-função-múltipla)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1.4. Análise de teste de hipóteses](#Análise-de-teste-de-hipóteses)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1.5. Colunas calculadas](#Colunas-calculadas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.1.6. Medidas](#Medidas)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3.2.2. Escrever fórmulas DAX](#Escrever-fórmulas-DAX)

[4. Criar elementos visuais e relatórios do Power BI](#Criar-elementos-visuais-e-relatórios-do-Power-BI)

[5. Gerenciar espaços de trabalho e modelos semânticos no Power BI](#Gerenciar-espaços-de-trabalho-e-modelos-semânticos-no-Power-BI)

[6. Fonte](#Fonte)

# Descobrir a análise de dados

# Introdução à análise de dados da Microsoft

O papel do analista de dados é fundamental no cenário atual, onde as organizações geram e armazenam grandes volumes de dados diariamente. Esses dados vêm de diversas fontes, como transações, serviços, redes sociais e comportamentos de consumo. O grande desafio das empresas é transformar esses dados em ações estratégicas que impulsionem os negócios.

Usar dados de forma eficaz pode ajudar no controle de inventário, identificação de padrões de consumo, recomendações personalizadas, detecção de fraudes e otimizações de preço, entre outras aplicações. No entanto, apenas coletar dados não é suficiente: é preciso interpretá-los e criar narrativas claras e significativas que apoiem a tomada de decisões.

Essa narrativa baseada em dados deve ser acessível, direcionada ao público certo e integrada ao dia a dia da organização, promovendo uma cultura orientada por dados. Para isso, o analista precisa trabalhar em parceria com engenheiros e cientistas de dados, garantindo que as análises gerem valor real.

Ao longo do processo, a análise de dados se torna uma ferramenta poderosa para descobrir insights, influenciar decisões e transformar dados em vantagem competitiva.

## Visão geral da análise de dados

Antes de servirem para contar uma história, os dados precisam passar por um processo de preparação — identificação, limpeza, transformação e modelagem — conhecido como análise de dados. Esse processo gera insights úteis que são apresentados por meio de relatórios e narrativas para apoiar a tomada de decisão.

Com o avanço do mundo orientado por dados, contar histórias com dados tornou-se essencial para empresas de todos os tamanhos, justificando a crescente demanda por analistas de dados. No entanto, muitas organizações ainda enfrentam o desafio de não utilizar todo o potencial dos dados.

A análise de dados é crucial para entender o impacto nos negócios, como identificar tendências, avaliar opiniões de clientes e conduzir pesquisas. Seus principais tipos são:

- Descritiva: o que aconteceu

- Diagnóstica: por que aconteceu

- Preditiva: o que pode acontecer

- Prescritiva: o que deve ser feito

- Cognitiva: uso de inteligência artificial para análises autônomas

### Análise descritiva

Responde à pergunta "o que aconteceu?" com base em dados históricos. 

Ela resume grandes volumes de dados para fornecer visão clara aos stakeholders, sendo essencial na criação e acompanhamento de KPIs (indicadores-chave de desempenho), como o ROI. É amplamente usada em relatórios de desempenho financeiro e de vendas, ajudando a avaliar o progresso de metas e objetivos.

### Análise diagnóstica

Busca responder à pergunta "por que algo aconteceu?". 

Ela aprofunda os resultados da análise descritiva para identificar as causas por trás de eventos ou mudanças nos indicadores de desempenho. O processo envolve três etapas:

- Identificar anomalias nos dados;

- Coletar dados relacionados a essas anomalias;

- Aplicar técnicas estatísticas para encontrar relações e tendências que expliquem o ocorrido.

### Análise preditiva

Responde à pergunta "o que poderá acontecer?". 

Ela utiliza dados históricos para identificar tendências e prever eventos futuros. Para isso, aplica técnicas de machine learning e estatística, como redes neurais, árvores de decisão e regressão, oferecendo insights valiosos para a antecipação de cenários.

### Análise prescritiva

Responde à pergunta "o que deverá ser feito?" para alcançar objetivos. 

Ela orienta a tomada de decisões baseada em dados, mesmo em cenários incertos. Utiliza machine learning para identificar padrões em grandes volumes de dados e, com base em decisões passadas, estima a probabilidade de diferentes resultados, ajudando as organizações a escolher as melhores ações.

### Análise cognitiva

Busca inferir conhecimento a partir de padrões e dados existentes, criando um ciclo de autoaprendizado ao alimentar novas descobertas em sua base de conhecimento. Diferente de regras fixas, suas hipóteses são não estruturadas e vêm de diversas fontes, com diferentes níveis de confiança. Utiliza machine learning e processamento de linguagem natural para interpretar dados complexos e não estruturados, como análises de produtos e logs de call center, ajudando a prever possíveis cenários futuros e a lidar com mudanças.

## Funções em dados

Criar uma narrativa com dados não começa com o analista — os dados vêm de outras fontes e, muitas vezes, prepará-los está fora do seu escopo. Projetos atuais são complexos e colaborativos, exigindo o trabalho conjunto de profissionais com habilidades complementares.

Antigas funções, como analistas de negócios e desenvolvedores de BI, evoluíram devido ao aumento e à diversidade dos dados, dando origem a papéis mais especializados nas áreas de engenharia e análise de dados, com foco em modernizar e simplificar o tratamento das informações.

As seguintes seções realçam as diferentes funções em dados e a responsabilidade específica no espectro total, de descoberta e compreensão de dados:

- Analista de negócios

- Analista de dados

- Engenheiro de dados

- Cientista de dados

- Administrador de banco de dados

### Analista de negócios

Apesar das semelhanças, a principal diferença entre analista de dados e analista de negócios está no uso dos dados. O analista de negócios atua mais próximo da empresa, focando na interpretação dos dados para apoiar decisões. Em alguns casos, ambas as funções podem ser desempenhadas por uma única pessoa.

### Analista de dados

O analista de dados ajuda as empresas a extrair valor dos dados por meio de ferramentas como o Power BI, sendo responsável por criação de perfis, limpeza, transformação e modelagem semântica de dados. Ele cria relatórios analíticos avançados e colabora com stakeholders para entender requisitos e gerar insights relevantes.

Também gerencia ativos do Power BI (relatórios, dashboards, workspaces e modelos), garantindo a segurança dos dados conforme as necessidades dos stakeholders. Trabalha em parceria com engenheiros de dados e administradores de banco de dados para localizar fontes adequadas, garantir acesso e melhorar processos de coleta e análise de dados.

### Engenheiro de dados

O engenheiro de dados é responsável por provisionar, configurar e gerenciar plataformas de dados locais e na nuvem, lidando com dados estruturados e não estruturados provenientes de diversas fontes. Ele garante que os serviços de dados estejam seguros e integrados, utilizando ferramentas para ingestão, transformação e saída de dados.

Colabora com stakeholders para entender os requisitos e desenvolver soluções. Seu papel vai além do do administrador de banco de dados, com foco em estruturar dados para apoiar projetos de BI e ciência de dados.

Trabalha em conjunto com analistas de dados, garantindo o acesso às fontes e otimizando modelos semânticos oriundos de data lakes ou data warehouses modernos. Profissionais de BI e DBAs podem migrar para essa função aprendendo as tecnologias voltadas ao processamento de grandes volumes de dados.

### Cientista de dados

Os cientistas de dados realizam análises avançadas, que vão desde a exploratória (EDA) até a preditiva, utilizando machine learning para identificar padrões e anomalias. Alguns atuam também com aprendizado profundo, criando algoritmos personalizados para resolver problemas complexos.

Grande parte do trabalho envolve estruturação de dados e engenharia de atributos, tarefas que podem ser otimizadas com apoio de engenheiros de dados. Embora pareçam distintos, cientistas e analistas de dados trabalham de forma complementar: o cientista formula hipóteses e experimentos, enquanto o analista ajuda na visualização e geração de relatórios.

### Administrador de banco de dados

O administrador de banco de dados (DBA) gerencia os aspectos operacionais de soluções de dados em ambientes híbridos e em nuvem, como Azure e SQL Server. É responsável pela disponibilidade, desempenho, segurança, além de backups e planos de recuperação.

Diferente do engenheiro de dados, que atua na estruturação e preparação dos dados, o DBA foca na integridade dos bancos de dados, no hardware envolvido e no controle de acesso, garantindo que os dados estejam protegidos e otimizados para o uso empresarial.

## Tarefas de um analista de dados

O analista de dados desempenha um papel essencial nas organizações, ajudando a descobrir e compreender informações que mantêm a empresa eficiente e equilibrada. Para isso, é fundamental que conheça bem suas responsabilidades e tarefas diárias.

Além de gerar insights valiosos a partir dos dados disponíveis, o analista colabora com outros profissionais da organização para revelar informações relevantes durante todo o processo de análise de dados, que envolve cinco áreas principais:

### Preparar

Como analista de dados, grande parte do seu tempo será dedicada à preparação e modelagem dos dados, pois dados incorretos podem gerar relatórios inválidos, perda de confiança e impactos negativos nos negócios.

A preparação de dados transforma dados brutos em informações confiáveis e compreensíveis, envolvendo tarefas como: analisar o perfil (características, qualidade e estrutura), limpeza, correção de erros, identificação de dados ausentes, conversão de formatos, melhoria da legibilidade.

Também exige decisões sobre conexões de dados, desempenho, e garantias de privacidade e segurança, como anonimização ou remoção de dados sensíveis. Embora possa ser um processo demorado, é essencial para garantir qualidade e insights confiáveis.

### Modelar

Após a preparação, os dados estão prontos para a modelagem, que consiste em definir relações entre tabelas. Um modelo semântico bem construído é essencial para gerar relatórios precisos, rápidos e fáceis de manter.

Modelos mal planejados afetam negativamente o desempenho e a precisão dos relatórios, principalmente em grandes volumes de dados. No Power BI, problemas de lentidão ou atualização costumam indicar falhas na preparação ou modelagem.

A preparação e modelagem são processos iterativos e interdependentes. Compreender e preparar bem os dados facilita muito a criação de um modelo eficaz.

### Visualizar

A visualização de dados dá vida aos dados e tem como objetivo principal resolver problemas empresariais. Relatórios bem projetados contam uma narrativa clara e envolvente, permitindo que tomadores de decisão compreendam rapidamente os insights e tomem decisões precisas.

Para isso, o analista de dados deve entender o problema da empresa e evitar excesso de informações, criando uma narrativa concisa que destaque os pontos-chave. As ferramentas de IA do Power BI ajudam a criar relatórios avançados sem a necessidade de código, facilitando a descoberta de insights.

A acessibilidade também é essencial: os relatórios devem ser pensados para atender a todos os usuários desde o início. Cores, fontes, visualizações e layout devem trabalhar juntos para construir uma narrativa visual eficaz.

### Analisar

A etapa analisar consiste em entender e interpretar os dados exibidos nos relatórios. Como analista de dados, é essencial dominar os recursos analíticos do Power BI para identificar padrões, tendências e previsões, comunicando esses insights de forma clara.

A análise avançada permite decisões mais eficazes, geração de insights acionáveis e uma visão aprofundada do comportamento e dos dados da empresa. Antes restrita a especialistas, hoje a análise está mais acessível graças ao Power BI, que facilita o trabalho com elementos visuais, métricas e dashboards.

As integrações de IA com o Power BI — como Azure Machine Learning e serviços cognitivos — elevam o nível da análise, tornando os relatórios mais poderosos e enriquecidos.

### Gerenciar

O Power BI possui diversos componentes — como relatórios, dashboards, workspaces e modelos semânticos — que o analista de dados deve gerenciar com responsabilidade, garantindo compartilhamento seguro e distribuição eficaz dos ativos.

Aplicativos facilitam a distribuição para grandes públicos, com navegação personalizada e integração com outros ativos da organização. Um bom gerenciamento promove colaboração, acesso controlado e evita vazamento de dados.

Também ajuda a reduzir silos e duplicações, reutilizando modelos semânticos e garantindo confiabilidade por meio de modelos certificados. Com isso, o Power BI apoia uma gestão eficiente e segura dos dados corporativos.

# Comece a criar com o Power BI

O Microsoft Power BI é uma solução completa para preparação, visualização, distribuição e gerenciamento de dados. Ele permite criar relatórios interativos e visualmente atrativos, desde os mais simples até os mais complexos com modelagem de dados. É uma ferramenta essencial para analistas de dados, mas todos os profissionais da área podem se beneficiar ao entender seu funcionamento para explorar e comunicar insights.

## Usando o Power BI

Para criar relatórios no Power BI, é essencial conhecer seus três componentes principais:

- Power BI Desktop: ferramenta de desenvolvimento usada para criar relatórios, disponível gratuitamente.

- Power BI Service: plataforma online para organizar, gerenciar e compartilhar relatórios, acessível via app.powerbi.com.

- Power BI Mobile: aplicativo que permite visualizar relatórios otimizados em dispositivos móveis.

## Explore o fluxo do Power BI

Há um fluxo comum ao criar relatórios com o Power BI. Primeiro, você começa com Power BI Desktop para se conectar aos dados e criar o relatório. Em seguida, publica o relatório no serviço do Power BI e distribui aos consumidores.

O fluxo do Power BI é:

- Conectar-se a dados com o Power BI Desktop
  
- Transformar e modelar dados com Power BI Desktop.
  
- Criar visualizações e relatórios com Power BI Desktop.
  
- Publicar o relatório no serviço do Power BI.
  
- Distribuir e gerenciar relatórios no serviço do Power BI.

O serviço do Power BI também permite criar painéis de alto nível que fazem busca detalhada em relatórios e aplicativos para agrupar facilmente relatórios relacionados aos usuários em um formato simples.

## Blocos de construção do Power BI

Os blocos de construção do Power BI são modelos semânticos e visualizações. Crie um modelo semântico e use visuais para criar um relatório.

### Crie um modelo semântico

Um modelo semântico consiste em:

- Conectar-se a todas as fontes de dados necessárias
  
- Limpar e transformar os dados de acordo com as necessidades

- Adicionar relações entre tabelas

- Cálculos para estender o modelo semântico

### Crie visualizações em um relatório

No Power BI Desktop, as visualizações são adicionadas às páginas do relatório. É ideal manter cada página simples com dados relacionados, para que os consumidores possam ver facilmente os insights.

O Power BI é uma solução low-code, o que significa que você pode "arrastar e soltar" o campo de dados diretamente na tela. O Power BI escolherá um visual para o campo de dados. Você pode alterar facilmente entre visuais para os mesmos campos e adicionar ou remover campos de dados ao visual.

Os relatórios do Power BI são interativos. Os usuários podem clicar em visuais para filtrar ou detalhar informações, explorando os dados de forma dinâmica e visualizando como um gráfico afeta os outros na página.

Quando estiver satisfeito com seu relatório, publique-o no serviço do Power BI.

### Crie um painel

No Power BI Service, é possível criar painéis com blocos fixados de relatórios publicados. 

Os painéis consistem em uma única página composta por blocos. Para adicionar blocos a um painel, fixe um visual em um relatório no painel. Os blocos não são interativos como os visuais; portanto, quando um usuário interage com o bloco, ele acessa o relatório subjacente para obter mais informações.

Para recapitular:

- Os blocos de construção do Power BI são modelos semânticos e visualizações.
  
- Com o Power BI Desktop, crie o modelo semântico e use visuais para criar relatórios.
  
- Com o Power BI Service, você pode distribuir conteúdo para seus consumidores e usar relatórios para criar painéis.

## Tour e uso do Power BI Service

### Workspaces 

São a base do serviço do Power BI. Ao publicar qualquer relatório, você deve escolher um espaço de trabalho. Por padrão, todo usuário tem acesso ao Meu espaço de trabalho, que é ideal apenas para testes. Quando você desejar compartilhar conteúdo com outras pessoas, sempre crie e use um espaço de trabalho compartilhado.

### Seção Aprender

Se ainda não tiver criado um relatório, o Power BI oferecerá vários exemplos para você explorar. Esses relatórios são carregados no Meu espaço de trabalho para que você possa explorá-los em particular. Você pode acessar no painel de navegação.

### Seção Aplicativos

No Power BI, você pode criar aplicativos em espaços de trabalho para compartilhar relatórios e painéis de forma controlada e simplificada. Após cada alteração, é necessário atualizar o aplicativo, garantindo que só a versão desejada seja vista pela audiência. Os aplicativos são ideais para compartilhamento organizado, evitando permissões excessivas ou visualização de conteúdo ainda não finalizado. Os aplicativos modelo permitem que você encontre um aplicativo existente que atenda às suas necessidades e, em seguida, conecte seus dados. Esses aplicativos podem ser uma ótima maneira de compartilhar insights rapidamente com o mínimo de esforço.

### Atualizar um modelo semântico

Para dar suporte para seus dados em constante alteração, é possível configurar atualizações agendadas de seus modelos semânticos no serviço do Power BI. Também estão disponíveis atualizações sob demanda.

> Dica:
> 
> Para acessar aplicativos de modelo no Power BI:
> 
> 1. Selecione o ícone **Aplicativos** no painel de navegação à esquerda.  
> 2. Clique em **Obter aplicativos**.  
> 3. Vá até a guia **Aplicativos de modelo**.

# Introdução à análise de ponta a ponta usando o Microsoft Fabric

O Microsoft Fabric é uma plataforma de análise de ponta a ponta que fornece um ambiente único e integrado para profissionais de dados e a empresa colaborarem em projetos de dados. Ele fornece um conjunto de serviços integrados que permitem ingerir, armazenar, processar e analisar dados em um único ambiente.

O Fabric inclui os seguintes serviços:

- Engenharia de dados
- Integração de dados
- Armazenamento de dados
- Inteligência em tempo real
- Ciência de dados
- Inteligência empresarial

## Explorar análises de ponta a ponta com o Microsoft Fabric

O Microsoft Fabric simplifica as soluções de análise fornecendo um produto único e fácil de usar que integra várias ferramentas e serviços em uma plataforma. É uma plataforma saaS (software como serviço) unificada em que todos os dados são armazenados em um único formato aberto no OneLake. 

### OneLake

O OneLake é o armazenamento centralizado do Microsoft Fabric, baseado no Azure Data Lake Storage (ADLS). Ele unifica dados entre regiões e nuvens em um único lago lógico, eliminando a necessidade de mover ou duplicar dados.

- Suporta múltiplos formatos: Delta, Parquet, CSV, JSON.
- Todos os dados gerados no Fabric são armazenados automaticamente no OneLake.
- Dados tabulares usam o formato delta-parquet para integração perfeita entre mecanismos.
- Atalhos permitem acesso a dados externos sem cópia, mantendo sincronia e consistência com a origem.

### Workspace

No Microsoft Fabric, os workspaces são contêineres lógicos que organizam e gerenciam dados, relatórios e ativos. Eles:

- Controlam permissões para acesso seguro e colaboração.
- Separaram recursos para facilitar a gestão e segurança.
- Permitem gerenciar recursos de computação e integrar com o Git para controle de versão, colaboração e histórico de alterações.

### Administração e governança

A administração e governança no Microsoft Fabric são centralizadas por meio do portal de administração. Nele, é possível:

- Gerenciar permissões, grupos, fontes de dados e gateways.
- Monitorar uso e desempenho.
- Usar APIs e SDKs para automação e integração.

O catálogo do OneLake ajuda a monitorar e manter a governança, oferecendo informações sobre metadados, rótulos de confidencialidade e status de atualização dos dados.

## Explorar as equipes de dados e o Microsoft Fabric

O Microsoft Fabric é uma plataforma unificada de análise de dados que facilita a colaboração entre profissionais ao eliminar silos de dados e a dependência de múltiplos sistemas.

### Funções e desafios tradicionais

No modelo tradicional de análise de dados, há desafios causados pela divisão de tarefas entre engenheiros, analistas e cientistas de dados. Isso gera:

- Atrasos e retrabalho por causa da dependência entre equipes.
- Analistas precisam fazer transformações extras, muitas vezes sem contexto adequado.
- Cientistas de dados enfrentam dificuldades de integração com sistemas existentes, dificultando a geração de insights.

### Evolução dos fluxos de trabalho colaborativos

O Microsoft Fabric unifica ferramentas de análise em uma única plataforma SaaS, permitindo colaboração eficiente entre funções sem duplicação de esforços:

- Engenheiros de dados usam Pipelines e Notebooks para ingerir, transformar e armazenar dados no OneLake com Delta-Parquet com controle de versão.
- Analistas de dados podem preparar os dados antecipadamente com fluxos de dados e acessar o OneLake via Direct Lake, o que diminui a necessidade de ajustes posteriores. Isso torna a criação de relatórios interativos no Power BI mais ágil e eficiente.
- Cientistas de dados utilizam Python/Spark em notebooks e integram modelos ao Azure Machine Learning.
- Engenheiros de Analytics organizam dados nos lakehouses, criando modelos semânticos para análise de autoatendimento.
- Usuários low-code e desenvolvedores cidadãos acessam dados no Hub OneLake e criam relatórios com Power BI e fluxos de dados simples. Eles também podem usar fluxos de dados para executar tarefas ETL simples sem depender de engenheiros de dados.

## Habilitar e usar o Microsoft Fabric

Para usar todos os recursos do Microsoft Fabric, ele deve estar habilitado na organização. Isso pode exigir suporte do TI e o envolvimento de funções como:

- Administrador do Fabric: gerencia configurações do Fabric.
- Administrador do Power Platform: supervisiona serviços da plataforma, incluindo o Fabric.
- Administrador do Microsoft 365: gerencia os serviços Microsoft na organização, incluindo o Fabric.

### Habilitar o Microsoft Fabric

Os administradores podem habilitar o Fabric no **portal de administração > configurações do locatário** no serviço do Power BI. A habilitação pode ser feita para toda a organização ou para grupos de segurança específicos do Microsoft 365 ou Microsoft Entra. Também é possível delegar essa permissão a outros usuários no nível de capacidade.

### Criar workspace

Os workspaces são ambientes colaborativos no Microsoft Fabric onde se criam e gerenciam itens como lakehouses, warehouses e relatórios, com os dados armazenados no OneLake. Eles também mostram a linhagem de dados, facilitando a visualização do fluxo e das dependências.

Nas configurações do workspace, é possível definir:

- Tipo de licença para usar recursos do Fabric.
- Acesso do OneDrive para o espaço de trabalho.
- Conexão com o Armazenamento Azure Data Lake Gen2.
- Integração do Git para controle de versão.
- Configurações de carga de trabalho do Spark para otimização de desempenho.

O acesso é controlado por quatro funções: administrador, colaborador, membro e visualizador. Para controle mais detalhado, use permissões por item conforme a necessidade do negócio.

### Descobrir dados com o catálogo do OneLake

O catálogo do OneLake no Microsoft Fabric facilita o acesso e descoberta de dados dentro da organização. Os usuários visualizam apenas os itens compartilhados com eles e podem:

- Restringir resultados por workspace ou domínio.
- Navegar por categorias padrão.
- Filtrar por palavra-chave ou tipo de item.

### Criar itens utilizando as cargas de trabalho do Fabric

Após criar um workspace habilitado para o Microsoft Fabric, você pode começar a criar e gerenciar itens conforme a carga de trabalho desejada. O Fabric oferece recursos para:

- Engenharia de dados: criar e transformar dados com lakehouses.
- Data Factory: ingerir, transformar e orquestrar dados.
- Ciência de dados: aplicar machine learning para prever e detectar padrões.
- Data Warehouse: unificar dados em armazéns tradicionais.
- Bancos de dados: criar e gerenciar bancos de dados com ferramentas para inserir, consultar e extrair dados.
- Soluções do setor: usar modelos prontos para diferentes áreas.
- Inteligência em tempo real: processar, monitorar e analisar dados de streaming.
- Power BI: criar relatórios e dashboards interativos.

O Microsoft Fabric unifica ferramentas como Power BI, Synapse Analytics e Data Factory em uma única plataforma e dá suporte à arquitetura data mesh, com governança centralizada e propriedade descentralizada, simplificando os fluxos sem exigir acesso direto ao Azure.

# Criar relatórios interativos usando o Copilot para Power BI

O Power BI permite preparar e visualizar dados com relatórios interativos, mas iniciantes podem ter dificuldades. O Copilot para Power BI simplifica esse processo, ajudando a criar medidas, visuais e páginas de relatório de forma rápida. Este módulo ensina como usar o Copilot para tornar a análise e geração de relatórios mais fáceis e eficientes.

## Prepare seus dados para uso com o Copilot para Power BI

O Microsoft Power BI permite criar relatórios interativos em três etapas principais: preparar e modelar os dados, visualizar e analisar e proteger e distribuir os relatórios. Essas etapas podem ser demoradas para iniciantes, mas o Copilot para Power BI ajuda a acelerar o processo ao:

- Criar medidas com linguagem natural.
- Adicionar sinônimos ao modelo para melhorar a experiência de Q&A.
- Gerar visuais e páginas automaticamente.
- Resumir o modelo de dados.

Apesar disso, a limpeza e transformação dos dados ainda precisam ser feitas manualmente para garantir a precisão.

### Garantir a qualidade dos dados

A qualidade dos dados é essencial para criar relatórios precisos e confiáveis no Power BI, especialmente ao usar o Copilot. Sem dados de qualidade, os resultados podem ser comprometidos. É importante avaliar o modelo semântico, considerando aspectos como:

- Completude: valores ausentes geram lacunas nos dados.
- Validade: valores fora do esperado distorcem análises.
- Consistência: dados incoerentes afetam visuais, especialmente de datas.
- Exclusividade: duplicatas prejudicam a precisão.
- Relacionamentos: ausência de ligações entre tabelas impede visuais corretos.
- Cálculos DAX: fórmulas limitadas reduzem os insights.

### Preparar dados com o Power Query

O Power Query é essencial no Power BI Desktop para preparar o modelo semântico, sendo uma etapa inicial e fundamental, especialmente ao usar o Copilot. Ele ajuda a garantir a qualidade dos dados por meio de:

- Criação de perfil dos dados (qualidade, distribuição e perfil das colunas)
- Limpeza dos dados (corrigir inconsistências, valores nulos ou inesperados)
- Transformação dos dados (nomes amigáveis, tipos corretos e formatações adequadas)

## Use o Copilot para Power BI para modelar seus dados

Dados adequadamente preparados são a base para insights de dados. Depois de limpar, transformar e moldar seus dados, você pode começar a criar o modelo semântico.

### Conectar tabelas com relacionamentos

Após preparar os dados, o próximo passo é criar relacionamentos entre as tabelas, o que permite filtrar e resumir informações nos relatórios. É possível usar a detecção automática de relacionamentos e o Copilot para revisar e identificar a necessidade de ajustes no modelo semântico.

### Criar medidas rápidas

Mesmo com as tabelas conectadas, pode ser necessário criar medidas DAX para responder aos requisitos de negócio. O DAX é uma linguagem funcional poderosa e versátil, usada para cálculos no Power BI, mas pode ser complexa no início por diferir de linguagens tradicionais baseadas em etapas.

O Power BI oferece medidas rápidas, que facilitam a criação de cálculos personalizados com pouco esforço e ajudam a aprender DAX, atendendo às necessidades dos relatórios sem exigir conhecimento avançado.

### Consulta com DAX

Há quatro modos de exibição no Power BI Desktop: Relatório, Tabela, Modelo e Consulta DAX. No modo de exibição Consulta DAX, você pode selecionar Copilot na faixa de opções e usar linguagem natural para descrever o que deseja.

### Criar medidas a partir de consultas DAX

Criar medidas a partir de consultas DAX envolve usar consultas escritas em DAX para definir cálculos personalizados que podem ser reutilizados em relatórios do Power BI, permitindo análises dinâmicas e precisas.

Como desenvolvedor de relatórios, você pode Atualizar o modelo com alterações para criar as medidas mais adequadas ao seu projeto.

## Crie relatórios com o Copilot para Power BI

Entender o valor dos dados bem preparados e criar um modelo semântico é essencial para relatórios eficazes. Após isso, é possível visualizar os dados e gerar insights que apoiam a tomada de decisões com base em dados.

### Criar relatórios com o Power BI Desktop

O Power BI Desktop é a principal ferramenta para desenvolver relatórios, permitindo conectar, transformar, modelar e visualizar dados. O Copilot pode auxiliar na criação de visuais e relatórios dentro desse ambiente.

**Obs.: Você precisa estar conectado com uma conta que tenha acesso a um workspace antes de usar o Copilot.**

No Power BI, o Copilot funciona de forma semelhante a outros produtos da Microsoft. Ao clicar no botão Copilot, abre-se um painel com sugestões e chat. Você pode, por exemplo, pedir para:
- Criar uma nova página de relatório.
- Sugerir conteúdo para uma nova página de relatório.
- Responder a esta pergunta de dados... (em seguida, insira sua pergunta no chat).

### Criar relatórios com o Power BI Service

Ao publicar relatórios no Power BI Desktop, são criados dois itens no workspace:
- O relatório é a representação visual que você criou na exibição de Relatório no Power BI Desktop.
- O modelo semântico são os dados subjacentes, incluindo relacionamentos e medidas.

Para criar relatórios por meio do serviço do Power BI, comece selecionando as reticências (…) do modelo semântico e escolha Criar relatório.

Selecione o botão Copilot e veja uma experiência semelhante com solicitações sugeridas e campo de chat:
- Criar uma nova página de relatório.
- Sugerir conteúdo para uma nova página de relatório.

### Criar páginas com prompts personalizados

Você pode digitar solicitações personalizadas no Copilot com base nos seus dados e objetivos do relatório. Apesar de possíveis limitações, é possível pedir, por exemplo:

- Uma página com os 10 produtos mais vendidos.
- Um visual com as 3 cores mais vendidas.

### Considerações finais

Considere o Copilot como um rascunho inicial que precisa de revisão. Você pode manter os visuais ou ajustá-los (cores, rótulos etc.). Lembre-se:

- O Copilot está em constante atualização.
- Pode haver erros, então sempre revise o que ele gerar.

## Criar resumos com o Copilot para Power BI

Resumos ajudam a manter o público engajado ao oferecer uma visão clara e concisa, comunicando a mensagem principal, dando contexto e destacando pontos importantes na narrativa.

### Resumir com o visual Narrativa

O visual Narrativa no Power BI permite criar resumos personalizados com base nos dados dos visuais do relatório. É possível ajustar formatação, inserir prompts personalizados e escolher quais visuais incluir. O Copilot sugere:

- Apresente um resumo executivo.
- Responda a perguntas prováveis da liderança.
- Crie uma lista de insights com marcadores.

Disponível no Power BI Desktop e no Service, você pode comparar versões personalizadas e geradas pelo Copilot.

### Resumir no painel do Copilot

O painel do Copilot ajuda desenvolvedores a gerar ideias e consumidores a entender melhor os dados. Ele considera todos os dados do relatório, mesmo os ocultos por filtros. É possível solicitar resumos ou respostas para todo o relatório ou apenas para a página atual, conforme o escopo indicado.

# Preparar dados para análise com o Power BI

Você aprenderá a usar o Power Query para extrair dados de diferentes fontes de dados, escolher um modo de armazenamento e um tipo de conectividade. Você também aprenderá a criar o perfil, limpar e carregar dados no Power BI antes de modelar seus dados.

# Obter dados no Power BI

## Obter dados de arquivos

Organizações costumam exportar e armazenar dados em arquivos, como arquivos simples (.csv, .txt, largura fixa) ou planilhas do Excel (.xlsx). O Power BI Desktop permite importar dados de vários tipos de arquivos, incluindo os salvos localmente, usando a opção Obter dados.

### Localização do arquivo simples

A primeira etapa é determinar qual local de arquivo você quer usar:

- Local: O arquivo não é movido para o Power BI e não permanece um link para ele. Em vez disso, um modelo semântico é criado no Power BI e os dados são carregados para ele.

- OneDrive for Business: Esse método é eficaz para manter o arquivo e o seu modelo semântico, relatórios e painéis de controle do Power BI sincronizados.

- OneDrive Pessoal: Semelhante ao OneDrive for Business, mas exige login na conta pessoal.

- SharePoint – Sites de Equipe: Semelhante ao OneDrive for Business, mas com conexão via URL ou pasta raiz.

### Conectar-se aos dados em um arquivo

No Power BI, acesse Página Inicial > Obter dados, escolha o tipo de arquivo (ex.: Excel), localize-o e abra. Se necessário, autentique-se no serviço (como o OneDrive).

### Selecionar os dados do arquivo a serem importados

Após conectar o arquivo ao Power BI Desktop, o Navegador exibe as tabelas disponíveis. Você pode selecionar uma tabela para visualizar o conteúdo e garantir que os dados corretos sejam carregados no modelo do Power BI. Marque as desejadas e escolha:

- Carregar → Envia direto para o modelo.
  
- Transformar Dados → Abre o Power Query para revisão e limpeza antes de carregar.

### Alterar o arquivo de origem

Durante o desenvolvimento, se o local do arquivo de origem mudar, você deve atualizar o caminho no Power BI para manter os relatórios atualizados. Isso pode ser feito via:

- Configurações da fonte de dados
  
- Configurações de consulta

- Editor Avançado no Power Query.

Ao alterar o caminho, reconecte-se a um arquivo com a mesma estrutura, pois mudanças na estrutura (como renomear ou excluir colunas) podem quebrar o relatório.

## Obter dados de fontes de dados relacionais

### Conectar-se a dados em um banco de dados relacional

Você pode conectar-se a um banco de dados relacional no Power BI Desktop usando **Obter Dados** e **SQL Server (vamos usar como exemplo)**. Também pode ser usado o atalho de acesso rápido disponível ao lado do botão.

A próxima etapa é informar o servidor e o banco de dados no SQL Server, escolhendo o modo de conectividade: Importação (padrão e mais usado) ou DirectQuery. As opções avançadas podem ser ignoradas por enquanto.

Escolha o tipo de autenticação:
- Windows
- Banco de Dados
- Conta Microsoft, insira usuário e senha e clique em Conectar.

### Selecionar dados para importar

Após conectar, o navegador mostra as tabelas do banco. Marque as desejadas e escolha Carregar (importa direto) ou Transformar Dados (abre no Power Query para ajustes).

### Importar dados escrevendo uma consulta SQL

Também é possível importar dados escrevendo uma consulta SQL. Basta informar servidor e banco, abrir Opções avançadas, digitar a instrução (ex.: SELECT ID, NAME, SALESAMOUNT FROM SALES) e confirmar.

### Alterar configurações da fonte de dados

Após criar e carregar dados no Power BI Desktop, você pode alterar as configurações de conexão a qualquer momento, como atualizar senhas, modificar a fonte de dados ou editar permissões.

Para isso:

- Na guia Página Inicial, selecione Transformar Dados > Configurações da fonte de dados.

- Escolha a fonte desejada e clique com o botão direito ou use os botões de opção para atualizar.

- Também é possível alterar detalhes no Power Query, selecionando a tabela e acessando Configurações da fonte de dados ou usando o painel Configurações de Consulta.

- Após as alterações, selecione Fechar e Aplicar para atualizar o modelo do Power BI.

### Escrever uma instrução SQL

Como mencionado anteriormente, SQL é útil no Power BI porque permite carregar apenas os dados necessários, escolhendo colunas, linhas, aplicando filtros, cálculos, junções e lógica diretamente na consulta antes de importar para o modelo.

A melhor prática é usar views no banco em vez de consultas SQL diretas no Power BI, pois elas funcionam como tabelas, permitem a otimização via dobragem de consultas (Query Folding) no Power Query e garantem melhor desempenho e manutenção.

## Criar relatórios dinâmicos com parâmetros

Relatórios dinâmicos permitem que um único relatório atenda a diferentes necessidades, reduzindo o número de relatórios a criar e economizando recursos. Com parâmetros, os usuários podem filtrar e personalizar os dados exibidos, ganhando mais autonomia. No exemplo da equipe de vendas, cada membro pode filtrar o relatório para ver apenas seus próprios resultados e comparar com as metas.

### Criar relatórios dinâmicos para valores individuais

Para criar um relatório dinâmico, primeiro escreva sua consulta SQL. No Power BI Desktop, use Obter dados, conecte-se ao banco de dados (SQL Server, por ex.):

1. Selecione **Opções avançadas**.

2. Cole a consulta SQL na caixa **Instrução SQL** e selecione **OK**:
```
SELECT 
    [SalesOrderID],
    [OrderDate],
FROM 
    [TailwindTraders].[Sales].[SalesOrderHeader] s
WHERE 
    s.[SalesPersonID] = 279
```
Quando a conexão for estabelecida, os dados serão mostrados na janela de visualização.

3. Selecione Editar para abrir os dados no Editor do Power Query
   
Em seguida, você criará o parâmetro seguindo estas etapas:

1. Na guia **Página Inicial**, selecione **Gerenciar parâmetros > Novo parâmetro**.

2. Na janela **Parâmetros**, altere o nome do parâmetro padrão para algo mais descritivo. Assim, a finalidade dele fica clara. Nesse caso, altere o nome para **SalesPerson**.
   
Selecione o **Texto** na lista **Tipo**, selecione **Qualquer valor** na lista **Valor sugerido** e então "OK".

Uma nova consulta é mostrada para o parâmetro que você criou.

Agora você precisa ajustar o código na consulta SQL para avaliar o novo parâmetro e torná-lo dinâmico:

1. Clique com o botão direito do mouse em **Query1** e selecione **Editor avançado**.

2. Substitua o valor existente na instrução de execução por um "E" comercial (e) seguido pelo nome do parâmetro **(SalesPerson)**, conforme ilustrado na imagem a seguir.
```
[Freight]#(lf), [TotalDue]#(lf) FROM [TailwindTraders].[Sales].[SalesOrderHeader] s#(lf) WHERE s.[SalesPersonID] = "&SalesPerson])
```
3. Verifique se não há nenhum erro exibido na parte inferior da janela e selecione **Concluído**.

Embora você não veja nenhuma diferença na tela, o Power BI terá executado a consulta.

4. Para confirmar que a consulta foi executada, você pode executar um teste selecionando a consulta de parâmetro e inserindo um novo valor na caixa **Valor Atual**.

5. Um ícone de aviso pode ser exibido ao lado da consulta. Se esse for o caso, selecione essa consulta para ver a mensagem de aviso, que informará que a permissão é necessária para executar essa consulta de banco de dados nativo. Selecione **Editar Permissão** e **Executar**.

Quando a consulta é executada com êxito, o parâmetro exibe o novo valor.

6. Selecione **Fechar e Aplicar** para voltar para o editor de relatório.

Agora você pode aplicar o parâmetro ao relatório:

1. Selecione **Editar consultas > Editar parâmetros**.

2. Na janela **Editar Parâmetros**, insira um novo valor e selecione **OK**.

3. Selecione **Aplicar alterações** e execute a consulta nativa novamente.

Agora, ao exibir os dados, você verá os dados do novo valor passados pelo parâmetro.

### Criar relatórios dinâmicos para vários valores

Crie no Excel uma tabela com uma coluna listando os valores desejados. Em seguida, utilize o Obter Dados no Power BI Desktop para conectar-se a essa planilha e prosseguir com as etapas de importação:

1. Na janela **Navegador**, selecione **Transformar Dados** para abrir os dados no Editor do Power Query.

2. Renomeie a coluna na tabela para algo mais descritivo.

3. Altere o tipo de dados da coluna para **Texto** para que ele corresponda ao tipo de parâmetro e você evite problemas de conversão de dados.

4. Na seção **Propriedades** da consulta, altere o nome da fonte de dados para algo mais descritivo. Neste exemplo, insira **SalesPersonID**.

Em seguida, você precisa criar uma função que passe a nova consulta **SalesPersonID** para **Query1*:

1. Clique com o botão direito do mouse em **Query1** e selecione **Criar função**.

2. Insira um nome para a função e selecione **OK**.

Sua nova função aparece no painel de **Consultas**.

3. Para evitar que **Query1** apareça na lista de campos e cause confusão, basta desabilitar seu carregamento no relatório, clicando com o botão direito sobre ela e desmarcando **Habilitar carregamento**.

4. Selecione a consulta **SalesPersonID** e, na guia **Adicionar Coluna**, use **Invocar função personalizada** para executar a função criada.

5. Na janela **Invocar Função Personalizada**, selecione a função na lista **Consulta de função**.

O **Nome da nova coluna** é atualizado automaticamente e a tabela que contém os valores que você vai passar pelo parâmetro é selecionada por padrão.

6. Selecione **OK** e, se necessário, execute a consulta nativa.

Uma nova coluna para sua função **GetSalesFromSalesPerson** aparece ao lado da coluna **SalesPersonID**.

7. Selecione o ícone de duas setas no cabeçalho da nova coluna e marque as caixas de seleção das colunas que você deseja carregar. Esta seção é onde você determinará os detalhes que estarão disponíveis no relatório para cada valor (ID do vendedor).

8. Desmarque a caixa de seleção **Usar o nome da coluna original como prefixo** na parte inferior da tela, pois você não precisa ver um prefixo com os nomes de coluna no relatório.

9. Selecione **OK**.

Você pode ver os dados das colunas selecionadas para cada valor (ID do vendedor). Se necessário, você poderá adicionar mais valores (IDs de vendedores) à coluna SalesPersonID na planilha do Excel ou alterar os valores existentes.

10. Salve as alterações e retorne para o Editor do Power Query.

11. Na guia **Página Inicial**, selecione **Atualizar Visualização** e execute a consulta nativa novamente (se necessário). Você deverá ver as vendas das novas IDs de vendedores que você adicionou à planilha.

12. Selecione **Fechar e Aplicar** para retornar ao editor de relatório, em que você verá os novos nomes da coluna no painel Campos.

## Obter dados de um banco de dados NoSQL

Algumas organizações utilizam bancos de dados NoSQL, que são não relacionais, não usam tabelas e oferecem maior flexibilidade no armazenamento de dados.

Vamos usar como exemplo o Cosmos DB (NoSQL), onde os dados são armazenados em documentos JSON. Esses dados precisam ser importados para um modelo semântico no Power BI para geração de relatórios.

### Conectar-se a um banco de dados NoSQL (Azure Cosmos DB)

No Power BI Desktop, use **Obter dados > Mais... > Azure > Azure Cosmos DB** para conectar-se. Informe a URL do endpoint, banco e coleção ou selecione via navegador. Na primeira conexão, insira a chave da conta obtida no portal do Azure (Chave Primária no painel Chaves Somente Leitura).

### Importar um arquivo JSON

Como os dados em **JSON** são aninhados, é preciso **extrair e normalizar** antes de usá-los no Power BI. Após conectar ao **Cosmos DB**, selecione a tabela, clique em **Editar** no Power Query e use o **botão de expansão** para escolher os campos desejados. Depois, confirme os dados, aplique as transformações e carregue no Power BI, onde eles ficam em formato tabular e podem ser relacionados a outras fontes para criar relatórios.

## Obter dados de serviços online

Organizações usam diversos aplicativos (ex.: SharePoint, OneDrive, Dynamics 365, Google Analytics), cada um gerando seus próprios dados. O Power BI integra essas fontes para criar relatórios e insights mais completos.

### Conectar-se a dados em um aplicativo

Vamos usar o **SharePoint Online** como exemplo. Vá em **Obter dados > Serviços Online > Lista do SharePoint Online**, insira a **URL do site** (não precisa ser o caminho completo), clique em **OK** e faça login com sua conta Microsoft. Depois, escolha a lista desejada para carregar.

### Escolher os dados do aplicativo a serem importados

Após conectar ao **SharePoint**, o **Navegador** exibirá as tabelas e entidades do site. Você pode escolher a lista desejada e optar por carregar diretamente no Power BI ou abrir no Power Query para transformar os dados antes do carregamento.

## Selecionar um modo de armazenamento

No Power BI, a forma mais comum é o **Import**, armazenando-os no arquivo do relatório. Porém, em casos de **restrições de segurança** ou **volumes muito grandes**, a importação não é viável. Nesses cenários, usa-se o **DirectQuery**, que consulta os dados diretamente na fonte e garante atualizações em tempo real. Há três modos de armazenamento disponíveis: **Import, DirectQuery** e **Duplo (composto)**, que podem ser escolhidos nas propriedades da tabela no modo Modelo.

Vamos examinar mais de perto os diferentes tipos de Modos de Armazenamento:

### Modo Import

Cria uma **cópia local dos dados** no Power BI, permite **atualizações agendadas ou sob demanda** e é o **modo padrão** para criar relatórios.

### Modo DirectQuery

Permite consultar dados **diretamente na fonte** sem criar cópias locais, pois os dados não serão armazenados em cache, garantindo que os dados estejam sempre atualizados e respeitando as regras de segurança. É ideal para **grandes modelos** e evita problemas de desempenho (latência dos dados) ao carregar muitos dados no Power BI.

### Modo Duplo (composto)

Algumas tabelas são **importadas** e outras usam **DirectQuery**, permitindo que o Power BI escolha a forma mais eficiente de recuperar os dados para o relatório.

## Obter dados do Azure Analysis Service

O Azure Analysis Services é um serviço PaaS que permite criar modelos semânticos tabulares na nuvem, unificando dados de várias fontes, definindo métricas e aplicando segurança. Ele facilita análises rápidas e ad hoc em ferramentas como o Power BI.

A obtenção de dados do servidor do Azure Analysis Services é semelhante à obtenção de dados do SQL Server, pois você pode:

- Autenticar-se no servidor.
- Escolher o modelo que deseja usar.
- Selecionar as tabelas que você precisa.

As diferenças notáveis entre o Azure Analysis Services e o SQL Server são:

- Os modelos do Analysis Services já têm cálculos criados.
- Se você não precisar de uma tabela inteira, poderá consultar os dados diretamente. Em vez de usar a T-SQL (Transact-SQL) para consultar os dados, como você faria no SQL Server, você pode usar MDX (expressões MDX) ou DAX (Data Analysis Expressions).

### Conectar-se a dados no Azure Analysis Services

O **Azure Analysis Services** pode ser conectado ao **Power BI Desktop** pelo recurso *Obter Dados*. Você informa o servidor e o banco e escolhe:

- Importar: traz os dados para dentro do Power BI.
- Conexão em tempo real: usa o modelo e cálculos DAX já existentes no Azure, sem duplicar dados.

Os modelos do Azure Analysis Services são compatíveis com o Power BI, e a conexão em tempo real garante que relatórios sejam atualizados assim que o serviço é atualizado, sem depender de agendamentos no Power BI.

Assim como num banco relacional, você seleciona as tabelas que precisa e pode consultar o modelo via **DAX** ou **MDX**.

📌 Melhor prática: concentrar a modelagem e medidas no **Azure Analysis Services** e usar **conexão em tempo real** no Power BI, para centralizar regras de negócio e simplificar a solução.

## Corrigir problemas de desempenho

O **Power BI** oferece a ferramenta **Performance Analyzer** para identificar e resolver problemas de desempenho em relatórios. Por exemplo, ao criar relatórios de Vendas com **DirectQuery** de várias tabelas SQL, alguns visuais ou filtros podem demorar mais para carregar. O Performance Analyzer ajuda a **diagnosticar quais consultas ou elementos estão lentos** e otimizar o relatório.

### Otimizar o desempenho no Power Query

O desempenho do Power Query depende principalmente da performance da fonte de dados. Cada fonte (como SQL Server) tem suas próprias técnicas de otimização, como índices, ajuste de plano de execução e compactação de dados. O Power Query aproveita essas otimizações usando uma técnica chamada dobragem de consultas (query folding), que transfere o processamento para a fonte sempre que possível.

### Dobragem de consultas

A dobragem de consultas (query folding) no Power Query otimiza o desempenho do Power BI ao fazer com que as transformações realizadas no editor sejam executadas diretamente na fonte de dados, em vez de sobrecarregar o Power BI.

- Ela rastreia alterações como renomear colunas, mesclar dados ou filtrar linhas e converte essas ações em consultas nativas ou instruções SQL.
- Benefícios: atualizações mais rápidas, suporte a DirectQuery e modo Duplo e melhor aproveitamento dos recursos do servidor de dados.
- Nem todas as transformações permitem query folding (ex.: adicionar coluna de índice, mesclar tabelas de fontes diferentes ou alterar tipo de dado).
- Em geral, transformações que podem ser convertidas em SQL com SELECT, WHERE, GROUP BY, JOIN, etc. suportam query folding.
- Para verificar, use “Exibir Consulta Nativa” na última etapa aplicada; se disponível, a dobragem de consultas está ativa.

### Diagnóstico de consulta

O diagnóstico de consulta no Power Query ajuda a identificar gargalos de desempenho durante o carregamento e a transformação de dados, incluindo a execução de instruções SQL.

- Para usar: no **Power Query → Ferramentas → Iniciar Diagnóstico**.
- Após as transformações, selecione **Parar Diagnóstico**.
- A opção **Diagnosticar Etapa** mostra o tempo gasto em cada etapa, permitindo identificar quais etapas são mais lentas e precisam de otimização.

Essa ferramenta é útil para analisar desempenho de consultas, carregamento de modelos semânticos e atualizações de dados.

### Outras técnicas para otimizar o desempenho

- Processar dados na fonte original sempre que possível, evitando sobrecarregar o Power Query.
- Usar consultas SQL nativas em DirectQuery, evitando procedimentos armazenados ou CTEs complexas.
- Separar colunas de data e hora quando combinadas, melhorando a compactação e o desempenho no Power BI.

## Resolver erros de importação de dados

Ao importar dados para o Power BI, você pode encontrar erros resultantes de fatores como:

- Importações do Power BI provenientes de várias fontes de dados.
- Cada fonte de dados pode ter dezenas (e, às vezes, centenas) de mensagens de erro diferentes.
- Outros componentes podem causar erros, como discos rígidos, redes, serviços de software e sistemas operacionais.
- Frequentemente, os dados podem não estar em conformidade com nenhum esquema específico.

As seções a seguir abrangem algumas das mensagens de erro mais comuns que podem ser encontradas no Power BI.

### O tempo limite da consulta expirou

Em sistemas relacionais, vários usuários acessam os mesmos dados ao mesmo tempo. Para evitar que um único usuário monopolize os recursos, administradores configuram tempos limite de consulta (de segundos a minutos). Assim, ao puxar dados, como no SQL Server, pode ocorrer erro de timeout.

### Erro de Consulta do Power BI: O tempo limite expirou

O erro ocorre quando você tenta puxar muitos dados, pois a organização limita consultas pesadas para evitar lentidão no banco. Para resolver, reduza colunas ou linhas, use agregações, simplifique consultas ou divida em partes menores. Caso precise de toda a complexidade, extraia os dados em blocos separados e una-os depois no Power Query.

### Não foi possível localizar nenhum dado formatado como uma tabela

O erro ocorre quando o Power BI não encontra dados formatados como tabela no Excel. Para resolver, basta selecionar os dados na planilha, pressionar CTRL+T para criar uma tabela com cabeçalhos corretos e então importar novamente.

### Não foi possível encontrar o arquivo

O erro "Não foi possível localizar o arquivo" ocorre quando o arquivo foi movido ou teve permissões alteradas. Para corrigir, abra o Power Query, edite a consulta com erro e ajuste o caminho da origem para o novo local do arquivo.

### Erros de tipo de dados

Colunas em branco no Power BI podem ocorrer por erro na interpretação do tipo de dados. A solução depende da fonte; no SQL Server, por exemplo, pode-se converter o campo para o tipo correto diretamente na consulta.

Em vez de usar esta consulta:
```
SELECT CustomerPostalCode FROM Sales.Customers
```
Use esta consulta:
```
SELECT CAST(CustomerPostalCode as varchar(10)) FROM Sales.Customers
```
Definir o tipo correto na fonte de dados ajuda a evitar muitos erros no Power BI, que podem variar conforme o sistema de origem.

# Limpar, transformar e carregar dados no Power BI

## Formatar os dados iniciais

O Editor do Power Query permite transformar dados no Power BI sem alterar a fonte original, realizando ações como renomear colunas, converter tipos, remover linhas e definir cabeçalhos, garantindo que os dados estejam prontos para relatórios.

### Introdução ao Editor do Power Query

Para começar a formatar os dados, abra o Editor do Power Query: Página Inicial → Transformar dados

- Faixa de opções (parte superior): oferece guias e botões para adicionar transformações, configurar consultas e realizar diversas tarefas.

- Painel de consultas (lado esquerdo): exibição de todas as consultas disponíveis (tabelas).

- Exibição atual (centro): exibição de trabalho principal, que, por padrão, exibe uma visualização dos dados da consulta.

- Configurações de consulta (lado direito): informações relevantes, como nome da consulta, etapas de consulta e vários indicadores.

- Barra de status (parte inferior): informações da consulta, como tempo de execução, número de linhas e colunas, status de processamento e permite alterar o modo de exibição.

### Identificar cabeçalhos e nomes de colunas

O primeiro passo na formatação de dados é identificar a posição dos cabeçalhos e nomes de colunas. Se estiverem em linhas diferentes ou com nomes genéricos, os dados ficam difíceis de ler; ao localizar corretamente os cabeçalhos, é possível reorganizar e tornar os dados mais claros.

### Promover cabeçalhos

No Power Query, ao criar uma tabela, a primeira linha pode conter os nomes das colunas. Para corrigir, promova-a a cabeçalhos de duas maneiras:

- Página Inicial → Usar Primeira Linha como Cabeçalhos

- Botão suspenso da coluna 1 (lado esquerdo) → Usar Primeira Linha como Cabeçalhos.

### Renomear colunas

Para renomear, existem duas formas:

- Clique com o botão direito no cabeçalho → selecione Renomear

- Duplo clique no cabeçalho → edite o nome.

### Remover linhas superiores

Para eliminar linhas superiores em branco ou desnecessárias, use: Página Inicial → Remover Linhas → Remover Linhas Superiores.

### Remover colunas

Remover colunas desnecessárias é essencial e deve ser feito o quanto antes, inclusive na fonte de dados, para melhorar desempenho e foco no modelo. No Power Query, existem duas formas:

- Selecione as colunas que deseja **excluir** e use: Página Inicial → Remover Colunas.
  
- Selecione as colunas que deseja **manter** e use: Página Inicial → Remover Outras Colunas.

### Transformar colunas em linhas (Unpivot columns)

Isso é especialmente útil ao importar dados do Excel e facilita a criação de medidas DAX.

No Power BI, para transformar colunas em linhas (Unpivot), realce as colunas desejadas, selecione: Transformar → Transformar colunas em linhas (Unpivot Column).

### Dinamizar colunas (Pivot columns)

Para organizar dados simples e identificar padrões, use Transformar → Dinamizar Colunas (Pivot Column) para agregar valores (como Contagem, Soma, Média, etc.) por valores únicos de uma coluna.

## Simplificar a estrutura de dados

No Power BI Desktop, após importar dados de várias fontes, é recomendado padronizar e simplificar os nomes de tabelas e colunas no Power Query, tornando-os mais claros e consistentes para o usuário. Além disso, é importante revisar as consultas (tabelas) e o conteúdo das colunas, corrigindo valores quando necessário.

### Renomear uma consulta

É recomendável renomear consultas com nomes pouco claros ou técnicos para algo mais amigável e compreensível pelos usuários. Por exemplo, uma tabela importada com o nome FactProductTable pode ser renomeada para Produtos, facilitando a interpretação pelos usuários. No Editor do Power Query, basta **selecionar a consulta no painel**, **clicar com o botão direito** e escolher **Renomear** para ajustar o nome.

### Substituir valores

Você pode usar o recurso *Substituir Valores* no Editor do Power Query para substituir qualquer valor por outro valor.

Selecione: A coluna que contém os valores → Transformar → Substituir Valores.

Na caixa **Valor a ser Localizado**, digite o nome do valor que pretende substituir e, em seguida, na caixa **Substituir por**, digite o nome do valor correto e selecione **OK**.

### Substituir valores nulos

Fontes de dados podem conter valores nulos. Se mantidos, eles podem distorcer cálculos, como médias. A solução é substituir valores nulos por um número que faça sentido, garantindo resultados mais precisos.

### Remover duplicados

No Power Query, é possível manter apenas valores únicos em uma coluna, como no caso de categorias repetidas. Selecione: A coluna que contém os valores → Clicar com o botão direito → Remover duplicados

Antes de aplicar, recomenda-se copiar a tabela, permitindo comparar os resultados e utilizar tanto a versão original quanto a filtrada no modelo.

### Práticas recomendadas para nomear tabelas, colunas e valores

Não há regras fixas para nomes de tabelas, colunas e valores, mas é recomendável usar termos e abreviações comuns à sua organização. Prefira nomes descritivos, substitua sublinhados por espaços, seja consistente com abreviações e evite prefixos ou sufixos desnecessários. Ao definir valores, considere legibilidade nos relatórios, evitando textos muito longos, muito curtos ou siglas confusas.

## Avaliar e alterar os tipos de dados da coluna

Ao importar dados, o Power BI Desktop verifica as primeiras 1.000 linhas para detectar tipos de dados, mas erros podem ocorrer, especialmente em arquivos CSV ou Excel. Para evitar problemas de desempenho, recomenda-se revisar e corrigir os tipos de dados no Editor do Power Query, aplicar formatos adequados e ajustar o padrão de resumo das colunas antes de carregar os dados no modelo.

### Implicações de tipos de dados incorretos

Se o Power BI não detectar corretamente o tipo de dados, você poderá enfrentar problemas como impossibilidade de criar cálculos, hierarquias ou relacionamentos corretos. Por exemplo, uma coluna de data com tipo errado impede cálculos baseados em tempo, como “Pedidos Acumulados no Ano”, e impede a criação de hierarquias de datas para análises anual, mensal ou semanal.

Exemplo: Quantity of Orders YTD = TOTALYTD(SUM('Sales'[OrderQty]), 'Sales'[OrderDate])

```
Couldn't load the data for this visual
MdxScript(Model) (19, 40) Calculation error in measure 
'Sales'[Quantity of Orders YTD]: A column specified in the call to 
function 'TOTALYTD' is not of type DATE. This is not supported.

Copy details
Send a Frown        Close

```
### Alterar o tipo de dados da coluna

O tipo de dados de uma coluna pode ser alterado no Editor do Power Query ou na exibição de Tabela do Power BI Desktop, sendo recomendado fazer a alteração no Power Query antes de carregar os dados.

No Editor do Power Query, você pode alterar o tipo de dados da coluna de duas maneiras:

- Selecionar a coluna → Transformar → Tipo de Dados

- O outro método é selecionar o ícone de tipo de dados ao lado do cabeçalho da coluna e selecionar o tipo de dados correto na lista.

## Combinar várias tabelas em uma só

A capacidade de combinar consultas é eficiente porque permite **acrescentar (append)** ou **mesclar (merge)** diferentes tabelas ou consultas juntas.

### Acrescentar consultas

Ao acrescentar consultas, você está adicionando linhas de dados a outra tabela ou consulta.

Para criar uma única tabela consolidada com dados das tabela1, tabela2 e tabela3, é necessário:

1. Remover colunas desnecessárias, padronizar as tabelas para conter as mesmas colunas e garantir que as colunas relevantes tenham os mesmos nomes nas tabelas originais.

2. Navegue: Página Inicial → Acrescentar Consultas. É possível selecionar **Acrescentar Consultas como Novas** ou **Acrescentar Consulta**.

3. Abrirá uma janela onde é possível adicionar as tabelas que deseja acrescentar de **Tabelas Disponíveis** a **Tabelas para Acrescentar**.

4. Selecione OK. Você será encaminhado para uma nova consulta que contém todas as linhas das três tabelas.

### Mesclar consulta

Ao mesclar consultas, você está combinando os dados de várias tabelas em uma só com base em uma coluna que é comum entre as tabelas. Esse processo é semelhante à cláusula JOIN no SQL.

Para criar uma única tabela consolidada com dados das tabela1, tabela2 e tabela3, é necessário:

1. Navegue: Página Inicial → Mesclar Consultas. É possível selecionar **Mesclar Consultas como Novas** ou **Mesclar Consultas**.

2. Abrirá uma janela onde é possível escolher como unir as duas tabelas, um processo que também é semelhante às instruções JOIN no SQL
  a. Left outer (tudo da primeira que combine com a segunda).
  b. right outer (tudo da segunda que combine com a primeira).
  c. full outer (todas as linhas de ambos).
  d. inner (somente linhas que combinam).
  e. left anti (tudo da primeira que não combine com a segunda).
  f. right anti (tudo da segunda que não combine com a primeira).

3. Selecione OK. Você será encaminhado para uma nova consulta que contém todas as colunas das tabelas.

## Criar o perfil de dados no Power BI

A criação de perfil de dados é o processo de analisar os dados para identificar anomalias, entender sua estrutura e verificar estatísticas como contagem de linhas, distribuição, valores mínimo, máximo e média. Esse processo facilita a formatação, organização e compreensão da distribuição dos dados, reduzindo retrabalho na construção de relatórios. No Power BI, essa funcionalidade já está incorporada, permitindo explorar os dados de forma simples antes de criar os visuais.

### Examinar as estruturas de dados

Antes de analisar os dados no Power Query, é importante entender a estrutura em que eles estão organizados. No Power BI Desktop, a guia **Modelo** permite visualizar o modelo semântico, editar propriedades de colunas e tabelas, acessar o **Editor do Power Query** para transformações e gerenciar relacionamentos entre tabelas por meio da opção **Gerenciar Relacionamentos**.

### Localizar anomalias e estatísticas de dados

Ao acessar o Editor do Power Query, é possível identificar **anomalias** e entender a **distribuição dos dados** que foram importados em: Exibir → Visualização de Dados. 

Para isso, utilizam-se recursos como:

- Qualidade da Coluna: mostra porcentagens de valores válidos, inválidos e vazios.

- Distribuição da Coluna: apresenta a frequência de valores distintos e exclusivos.

- Perfil da Coluna: fornece estatísticas detalhadas (contagem de linhas, valores mínimo e máximo, nulos, zeros, média, desvio padrão etc.).

Os gráficos de **Distribuição de Valores** ajudam a encontrar padrões ou inconsistências (frequência de dados).

## Usar o Editor Avançado para modificar o código M

No Power Query, cada transformação gera uma etapa, que pode ser reordenada, excluída ou editada. Essas etapas, criadas pela interface gráfica, são registradas em código M, visível e editável no **Editor Avançado** (Exibir → Editor Avançado).

O código M é escrito de cima para baixo, onde etapas posteriores dependem das anteriores, por isso a ordem é importante. Cada etapa geralmente corresponde a uma ou duas linhas de código.

Embora não seja necessário dominar o M para usar o Power Query, ele pode ser útil para ajustes manuais, como alterar nomes ou personalizar consultas. A última etapa definida é sempre o resultado final da consulta.

# Escolher uma estrutura de modelo do Power BI

## Descrever conceitos básicos do modelo do Power BI

Esta unidade descreve os seguintes termos:

- Modelo de dados

- Conjunto de dados do Power BI
  
- Consulta analítica
  
- Modelo de tabela
  
- Design do esquema em estrela
  
- Modo de armazenamento de tabela
  
- Estrutura do modelo

### Modelo de dados

O modelo de dados do Power BI é um recurso otimizado para análise, consultado principalmente via DAX (no Power BI) ou MDX (em relatórios paginados e na análise no Excel). Ele também é chamado de **modelo semântico**, mas geralmente referido apenas como **modelo**.

### Conjunto de dados do Power BI

Ao publicar um modelo do Power BI Desktop no service, ele se torna um **conjunto de dados**, que serve como fonte para relatórios e dashboards. Nem todos os conjuntos de dados vêm do Desktop — alguns conectam-se a modelos no AAS/SSAS ou a dados em tempo real (push, streaming ou híbridos). Este módulo foca apenas nos modelos criados no Power BI Desktop.

### Consulta analítica

Relatórios e dashboards do Power BI consultam um **conjunto de dados** por meio de uma **consulta analítica**, que gera resultados de fácil interpretação. 

Essa consulta segue três fases sequenciais: 

- Filtrar (às vezes chamado de segmentação): Restringe os dados a um subconjunto, mas os valores filtrados não aparecem no resultado. Pode ser aplicada em nível de relatório, página ou visual. Também ocorre via RLS (segurança em nível de linha) ou em medidas que aplicam filtros.
  
- Agrupar: Divide o resultado da consulta em grupos, funcionando também como um filtro. A diferença é que, nesse caso, os valores usados no filtro aparecem no resultado — por exemplo, ao agrupar por cliente, cada grupo mostra explicitamente o cliente correspondente.: 
  
- Resumir: Gera um valor único a partir dos dados, geralmente por meio de funções de agregação como soma, contagem, mínimo ou máximo. Pode ser simples (agregando uma coluna) ou mais complexo, quando definido por uma medida em DAX.

### Modelo de tabela

Um modelo do Power BI é um modelo tabular. Um modelo tabular é composto por uma ou mais tabelas de colunas. Ele também pode incluir relações, hierarquias e cálculos.

### Design do esquema em estrela

Para criar um modelo tabelar otimizado no Power BI, recomenda-se o esquema em estrela, com tabelas de dimensões (descrição de entidades como produtos, pessoas, tempo) e tabelas de fatos (eventos ou observações, com chaves de dimensão e medidas numéricas). A tabela de fatos fica no centro da estrela e as dimensões nas pontas; nas consultas analíticas, dimensões filtram ou agrupam e fatos são resumidos.

### Modo de armazenamento de tabela

Cada tabela do Power BI (exceto pelas tabelas calculadas) possui um modo de armazenamento:

- Importação: dados são armazenados no modelo;

- DirectQuery: consultas vão diretamente à fonte de dados;

- Duplo: combina os dois, usando dados em cache quando eficiente e recorrendo à fonte quando necessário.

### Estrutura do modelo

O **modo de armazenamento** define a estrutura do modelo:

Importação: todas as tabelas usam o modo Importação;

DirectQuery: todas as tabelas usam DirectQuery e pertencem ao mesmo grupo de origem;

Composto: contém tabelas de mais de um grupo de origem.

## Determinar quando desenvolver um modelo de importação

Um **modelo de importação** é formado por tabelas com modo de armazenamento **Importação** e pode incluir **tabelas calculadas** criadas com fórmulas **DAX**.

### Benefícios do modelo de importação

Os modelos de importação são os mais usados no Power BI porque oferecem flexibilidade e desempenho. Eles:

- Suportam todas as fontes de dados;

- Permitem integrar dados de diferentes origens;

- Dão suporte completo a DAX e Power Query;

- Permitem criar tabelas calculadas;

- Oferecem melhor desempenho, já que os dados ficam em cache na memória e otimizados para consultas analíticas.

Por isso, o Power BI Desktop usa Importação como padrão ao obter dados.

### Limitações do modelo de importação

Apesar dos benefícios, os modelos de importação têm limitações, principalmente quanto ao **tamanho do modelo** e à **atualização dos dados**.

### Tamanho do modelo

O Power BI impõe limites de tamanho para conjuntos de dados:

- 1 GB em capacidades compartilhadas. Quando esse limite de tamanho for excedido, o conjunto de dados não será atualizado;

- > 10 GB em capacidades dedicadas (também conhecida como capacidades Premium) com configuração de conjunto de dados grande.

Para otimizar modelos e reduzir tamanho:

- Remover colunas e linhas desnecessárias;

- Agrupar e resumir dados;

- Usar tipos de dados otimizados (numéricos);

- Preferir colunas personalizadas no Power Query;

- Desabilitar carga de consultas e data/hora automática;

- Considerar DirectQuery para algumas tabelas.

O limite refere-se ao tamanho compactado do modelo, não aos dados originais da fonte.

### Atualização de dados

Os dados importados no Power BI precisam ser atualizados periodicamente para refletir informações atuais. Para manter os dados atualizados, você configura a atualização de dados agendada ou os consumidores do relatório podem executar uma atualização sob demanda.

**Atualização agendada:** Frequência de até 8 vezes/dia em capacidade compartilhada e até 48 vezes/dia em capacidade dedicada. Se a frequência de atualização não for suficiente, é possível usar DirectQuery, tabelas híbridas ou conjuntos de dados em tempo real.

**Carga de atualização:** Por padrão, toda a tabela é recarregada, o que pode sobrecarregar o sistema de origem. Uma solução pode ser a atualização incremental, que atualiza apenas as partições necessárias, tornando o processo mais rápido e eficiente. Avançados podem personalizar particionamento usando scripts e XMLA no Power BI Premium.

## Determinar quando desenvolver um modelo do DirectQuery

Um modelo **DirectQuery** é formado por tabelas configuradas nesse modo e ligadas a uma mesma fonte de dados.

**- Importação:** inclui todas as tabelas importadas e calculadas (só pode haver um por modelo).

**- DirectQuery:** inclui todas as tabelas DirectQuery relacionadas a uma fonte específica.

Se o modelo tiver apenas um grupo de origem (importação ou DirectQuery), ele é simples. Quando há mais de um grupo de origem, ele se torna um modelo composto.

Um grupo de origem é um conjunto de tabelas associadas a uma fonte.

### Benefícios do modelo DirectQuery

- Modelar fontes de dados grandes ou que mudam rapidamente:
  - Não exige atualização de dados no Power BI, pois as consultas feitas no relatório são repassadas diretamente para a fonte de dados.
  - É adequado para data warehouses, que seriam inviáveis de importar por completo devido seu tamanho. Permite consultas quase em tempo real quando os dados mudam com frequência.
 
- Impor a RLS de origem:
  - O DirectQuery pode aproveitar a RLS já definida no banco de dados de origem, evitando recriar regras no Power BI:
    - Funciona apenas em alguns bancos relacionais.
    - Requer configuração de logon único (SSO) para a fonte de dados.
   
  - Restrições de soberania de dados:
    - Quando há restrições de segurança que impedem a saída de dados da organização, não é possível usar importação.
   
  - Criar conjuntos de dados especializados:
    - O DirectQuery normalmente funciona com bancos relacionais, pois o Power BI traduz as consultas em SQL nativo.
    - É possível conectar-se a um conjunto de dados do Power BI ou a um modelo do Azure Analysis Services e transformá-lo em um modelo local DirectQuery.
      - O modelo original é chamado de remoto e o novo de local.
      - Você pode encadear até três modelos dessa forma.
      - Permite personalizar ou estender o modelo remoto (renomear objetos, criar medidas, colunas ou tabelas).
      - Ao adicionar novas tabelas (importação ou DirectQuery), criam-se grupos de origem, tornando o modelo composto
     
### Limitações do modelo DirectQuery

Principais limitações do DirectQuery:

- **Fontes limitadas:** só funciona com principais bancos relacionais, além de conjuntos de dados do Power BI e modelos do Azure Analysis Services.
  
- **Transformações restritas:** nem todas do Power Query são suportadas, pois precisam ser convertidas em consultas nativas (ex.: dinamizar colunas não é possível).

- **Desempenho:** consultas podem ser lentas se o banco não tiver otimização (índices, views materializadas) ou recursos suficientes.

- **Impacto no sistema de origem:** consultas analíticas podem prejudicar o desempenho de outras operações, como OLTP.

### Aprimorar o desempenho do modelo DirectQuery

Quando há uma justificativa para desenvolver um modelo DirectQuery, você pode atenuar algumas limitações de duas maneiras:

- Otimizações da fonte de dados:
  - Criar índices e views materializadas no banco de dados.
  - Garantir recursos suficientes para todas as cargas de trabalho.
  - Trabalhar junto com o proprietário do banco, para que ele compreenda o impacto das consultas analíticas.
 
- Tabelas de agregação definidas pelo usuário do DirectQuery:
  - São tabelas de modelo especiais ocultas (de usuários, cálculos e RLS):
    - Elas são ideais para consultas de maior granularidade em tabelas de fatos grandes.
    - Para consultar views materializadas na fonte, ou modo importação/agregações automáticas.
   
## Determinar quando desenvolver um modelo composto

Um modelo composto possui mais de um grupo de origem, geralmente um de importação e outro de DirectQuery. As vantagens e limitações de cada modo continuam valendo dentro do modelo composto.

### Benefícios do modelo composto

Há vários benefícios no desenvolvimento de um modelo composto.

- Flexibilidade de design: combina diferentes modos de armazenamento, equilibrando dados importados e DirectQuery.

- Melhora de desempenho: consultas a dados importados em cache são mais rápidas que consultas de passagem do DirectQuery.

- Extensibilidade: permite estender modelos remotos (como conjuntos de dados do Power BI) com novas colunas, tabelas ou medidas, criando um modelo especializado a partir de um principal.

### Limitações do modelo composto

Há várias limitações relacionadas aos modelos compostos:

- Tabelas de importação precisam de atualização periódica, pois podem ficar fora de sincronia com dados DirectQuery.

- Combinar dados importados e DirectQuery exige que o Power BI consolide os resultados, podendo afetar o desempenho.
  - Para melhorar, use tabelas de agregação de importação ou agregações automáticas e configure dimensões em modo duplo.
 
- Encadeamento de modelos: alterações em modelos upstream podem impactar modelos downstream; é recomendado analisar o impacto antes.

- Relações limitadas ocorrem entre tabelas de diferentes grupos de origem ou em cardinalidade muitos-para-muitos, podendo afetar cálculos e consultas.

### Aumentar o desempenho do modelo DirectQuery usando dados de importação

Quando há uma justificativa para desenvolver um modelo DirectQuery, você pode atenuar algumas limitações usando recursos específicos do Power BI que envolvem as tabelas de importação.

- No modo de importação, é possível usar tabelas de agregação definidas pelo usuário ou agregações automáticas (recurso Premium) para:
  - Direcionar consultas de fatos de maior granularidade para dados armazenados em cache, melhorando o desempenho.
  - Aumentar ainda mais a performance definindo tabelas de dimensões relacionadas em modo duplo.
 
- Modo de armazenamento duplo (combina importação e DirectQuery), permitindo que o Power BI escolha o modo mais eficiente para cada consulta:
  - Sempre que possível, as consultas usam dados em cache, melhorando o desempenho.
  - Funciona bem com tabelas de agregação de importação, permitindo que consultas de alta granularidade sejam atendidas inteiramente com dados armazenados em cache.
  - Visuais de segmentação e filtros baseados em dimensões são renderizados mais rapidamente, usando dados em cache.

### Fornecer dados em tempo real de um modelo de importação

Ao configurar uma tabela de importação com atualização incremental, você pode habilitar **Obter os dados mais recentes em tempo real com DirectQuery**:

O Power BI cria uma tabela híbrida, com partições de importação para dados antigos e uma partição DirectQuery para dados atuais.

Consultas usam cache para dados antigos e DirectQuery para dados recentes.

Esse recurso requer licença Premium.

### Escolher uma estrutura de modelo

- **Preferência pelo modelo de importação:** oferece mais flexibilidade, opções de design e desempenho rápido. Use técnicas de redução de dados para carregar menos informações.

- **Modelo DirectQuery:** indicado para grandes volumes de dados ou quando é necessário quase tempo real.

- **Modelo composto:**

  - Melhora desempenho de consultas DirectQuery.

  - Permite resultados quase em tempo real combinando importação e DirectQuery.

  - Permite estender conjuntos de dados do Power BI ou modelos do Azure Analysis Services.

  - Tabelas de agregação e tabelas de dimensões em modo duplo ajudam a atender consultas detalhadas do cache.

- **Modelo híbrido:** tabela de importação com partição DirectQuery para dados atuais, fornecendo resultados quase em tempo real.

- **Modelos especializados:** podem ser criados encadeando a modelos principais via DirectQuery, normalmente por analistas de negócios.

- **Observação importante:** é possível converter uma tabela DirectQuery em importação, mas não o contrário.

# Modelar dados com o Power BI

Modelagem de dados é o processo de organizar e formatar dados para criar um modelo semântico com relacionamentos e cálculos em DAX, garantindo análises precisas e permitindo a criação de relatórios claros e impactantes no Power BI.

# Configurar um modelo semântico

## Configurar relacionamentos

Quando o modelo tem várias tabelas, é preciso criar relacionamentos adequados entre elas. Esses relacionamentos permitem que filtros aplicados em uma tabela sejam propagados para outras, seguindo o caminho disponível. Assim, por exemplo, ao filtrar o campo Year da tabela Date, a tabela Sales é automaticamente filtrada, resumindo apenas as vendas daquele ano — comportamento esperado pelos autores de relatórios.

### Configurar opções de carregamento de dados

Antes de carregar dados no modelo, é importante revisar e ajustar as opções de **Carregamento de dados** do Power BI Desktop:

- Clique em **Arquivo** (canto superior esquerdo).
- Vá em **Opções e configurações**.
- Clique em **Opções**.
- No painel lateral, escolha a seção **Carregamento de dados**.

Você pode permitir que o Power BI detecte, importe, atualize ou exclua relacionamentos automaticamente, ou então criá-los manualmente na janela **Gerenciar relacionamentos** ou na **exibição de Modelo**. 

Em alguns casos, uma tabela pode permanecer sem relacionamento (tabela desconectada), sendo útil para cenários de teste de hipóteses ou uso de parâmetros de campo.

### Colunas

Cada relacionamento conecta uma coluna **de** a uma coluna **para**, que precisam ter o mesmo tipo de dado e valores correspondentes. 

É necessário garantir que a coluna usada como chave em um dos lados tenha valores únicos. Quando a fonte usa chaves compostas, deve-se transformá-las em uma chave única. Caso os tipos de dados não coincidam, é possível ajustá-los no Power Query.

### Noções básicas sobre cardinalidade

Cada relacionamento tem um tipo de cardinalidade, que é:

- Um para muitos (1:*)
- Muitos para um (*:1)
- Um para um (1:1)
- Muitos para muitos (*:*)

O Power BI define automaticamente a cardinalidade dos relacionamentos com base nos valores carregados, mas às vezes é preciso ajustá-la manualmente.

**- Um para muitos / Muitos para um:** mais comuns, usados em esquemas estrela (dimensão → fato).

**- Um para um:** relaciona tabelas com colunas únicas, mas geralmente é melhor mesclar no Power Query para simplificar o modelo.

**- Muitos para muitos:** usado quando não há colunas exclusivas, permitindo relacionar tabelas em diferentes níveis de granularidade (ex.: categoria ↔ produto).

Assim, escolher a cardinalidade correta garante relacionamentos consistentes e um modelo mais intuitivo.

### Noções básicas sobre direção do filtro cruzado

Um relacionamento de modelo define a direção do filtro cruzado, que controla como os filtros se propagam:

- **Um para muitos / Muitos para um** → única ou ambas as direções.
- **Um para um** → sempre ambas.
- **Muitos para muitos** → única para uma tabela, ou ambas.

A prática recomendada é evitar filtros em ambas as direções, pois pode afetar desempenho e confundir usuários.

Exceção: cenários de análise muitos-para-muitos, onde uma tabela de transição (ex.: vendedores ↔ regiões) é usada para permitir a propagação correta dos filtros entre dimensões e fatos.

### Relacionamentos ativos x inativos

Entre duas tabelas só pode existir um relacionamento ativo para propagação de filtros. Outros relacionamentos podem ser criados, mas ficam inativos e só funcionam em cálculos DAX usando USERELATIONSHIP.
Isso é comum em dimensões com múltiplas funções.

### Trabalhar com o diagrama do modelo

No diagrama do modelo, os relacionamentos aparecem como linhas que conectam as tabelas:

- Criar: arrastar e soltar colunas.
- Editar: clicar duas vezes no relacionamento.
- Interpretação:
  - Cardinalidade → ícones 1 (um) ou * (muitos).
  - Direção do filtro cruzado → setas no meio da linha.
  - Ativo → linha sólida; Inativo → linha pontilhada.
  - Passar o cursor mostra quais colunas estão relacionadas.

## Configurar tabelas

O modelo pode ser aprimorado após conter as tabelas, colunas e relacionamentos necessários. Nesse ponto, é possível ajustar propriedades de objetos (tabelas e colunas) e criar novos elementos, como hierarquias, medidas e parâmetros, para enriquecer a análise.

### Configurar propriedades de tabela

No Power BI Desktop, você pode criar e configurar objetos de modelo usando a **faixa de opções**, o painel **Dados**, o diagrama de **Modelo** e o **Painel de Propriedades**. A exibição **Modelo** com o **Painel de Propriedades** é recomendada, pois permite seleção múltipla e atualizações em massa.

Cada tabela de modelo possui:

- Nome: herdado do Power Query, deve ser único e amigável.
- Descrição: opcional, aparece ao passar o cursor sobre a tabela.
- Sinônimos: nomes alternativos para melhorar o uso de Perguntas e Respostas ou Copilot.
- Ocultação: tabelas podem ser ocultadas se não devem ser usadas diretamente pelos autores de relatório (ex.: tabelas de transição para relacionamentos muitos-para-muitos).

### Marcar tabelas de datas

O Power BI cria automaticamente tabelas de data/hora ocultas para colunas desse tipo, mas é recomendado **desabilitar esse recurso** e usar uma tabela de datas própria (existente ou calculada via DAX). Cada tabela de datas deve ter uma coluna de datas e ser **marcada como tabela de datas** para que funções de inteligência temporal do DAX funcionem corretamente. Ao marcar, o Power BI valida que a coluna tem **valores únicos, contínuos e sem em branco**.

## Configurar colunas

No Power BI, as colunas podem ter propriedades como nome, descrição, sinônimos e visibilidade. É comum ocultar colunas usadas apenas em relacionamentos. Os nomes devem ser únicos e, quando visíveis, ter nomes amigáveis. Alterar o nome no Power BI gera uma etapa no Power Query. Também é possível organizar colunas em pastas de exibição para facilitar quando há muitos campos.

### Configurar formatação de coluna

Cada coluna tem um tipo de dados, definido no Power Query, que determina como os valores são armazenados. Alterar o tipo no Power BI cria uma nova etapa na consulta. Já a propriedade formato define apenas como os valores são exibidos nos visuais, como mostrar números decimais em forma de moeda.

### Definir ordem de classificação

No Power BI, a ordem natural de classificação (alfabética para texto e crescente para números/datas) pode não ser adequada. Para ajustar, usa-se a propriedade **Classificar por Coluna**, escolhendo outra coluna com valores apropriados para ordenação, como um número de ano e mês.

### Categorizar dados

A propriedade Categoria de dados descreve o conteúdo de uma coluna e ajuda o Power BI a tratá-la corretamente. É útil para dados espaciais (latitude/longitude) ou URLs. Para URLs, pode-se definir como URL da Web (mostrada como ícone de link) ou URL de Imagem (mostrada como imagem em visuais como tabela, matriz ou cartão).

### Definir sumarização

A propriedade **Resumir por** define como colunas numéricas são agregadas por padrão (Soma, Mín, Máx, Média, Contagem, Contagem Distinta ou Nenhum). Colunas resumíveis aparecem com o símbolo **Ʃ**, e os autores de relatório podem escolher a forma de resumo nos visuais.

### Configurar hierarquias

As hierarquias são opcionais e ajudam os autores de relatórios a entender os relacionamentos entre colunas de uma tabela. Elas permitem navegação estruturada entre níveis, como Year → Quarter → Month. Mesmo sem hierarquia, o mesmo resultado pode ser obtido, mas com mais esforço. Hierarquias podem ter propriedades como descrição, sinônimos, pasta de exibição e oculto.

- Clique com o botão direito sobre a primeira coluna que será o nível mais alto da hierarquia.
  - Escolha “Criar hierarquia”.
  - Isso cria uma nova hierarquia com essa coluna como primeiro nível (geralmente chamada de “Hierarquia1”).

- Adicione outros níveis à hierarquia:
  - Clique com o botão direito nas próximas colunas que farão parte da hierarquia.
  - Selecione “Adicionar ao Hierarquia” → escolha a hierarquia criada.
  - A ordem define o caminho de navegação (nível mais alto → mais baixo).
 
## Configurar medida

Para sumarizações simples, os autores de relatório podem usar as agregações padrão nos visuais, mas cálculos mais complexos (como YTD ou lucro) exigem medidas.

Uma medida é uma fórmula DAX nomeada adicionada a uma tabela, aparece com ícone de calculadora e deve ter nome único. Medidas podem ser simples (Soma, Média) ou complexas (ex.: Sales Amount − Product Cost). 

Elas permitem cálculos avançados no modelo semântico. O Power BI também oferece Copilot ou Medidas rápidas para criar medidas sem escrever DAX manualmente.

### Usar medidas rápidas

As medidas rápidas permitem criar medidas selecionando um modelo de cálculo e arrastando campos; o Power BI gera a medida automaticamente. Como colunas, medidas podem ter descrição, sinônimos, pasta de exibição, oculto e formatação. A propriedade **Tabela inicial** define a tabela do modelo à qual a medida pertence. O Copilot pode gerar descrições automaticamente inspecionando a fórmula DAX.

## Configurar parâmetros

Um parâmetro no Power BI permite que usuários ajustem filtros ou cálculos sem alterar os dados originais. 

Existem dois tipos: **Intervalo numérico** e **Campos**.

### Criar um parâmetro de Intervalo numérico

Um parâmetro de Intervalo numérico define tipo de dado, mínimo, máximo, incremento e valor padrão. 

O Power BI cria uma **tabela calculada desconectada** e uma medida para filtrar a tabela. 

Ele permite cenários de teste de hipóteses, como aplicar uma taxa de câmbio hipotética em medidas. No painel Dados, aparece com um **ponto de interrogação (?)**.

Modelagem → Novo Parâmetro → Intervalo numérico.

### Criar um parâmetro de Campos

O parâmetro de Campos agrupa diferentes colunas para que o usuário escolha qual delas visualizar. 

Ele pode ser usado em visuais ou segmentações. Exemplo: um parâmetro **Product Grouping** com Category, Subcategory, Product e Color permite que o consumidor selecione o campo, e o gráfico atualiza o eixo conforme a escolha.

# Escrever fórmulas DAX para modelos semânticos

Data Analysis Expressions (DAX) é uma linguagem de fórmulas para o Power BI que permite criar cálculos, adicionar lógica e aprimorar a análise de dados em seus relatórios e modelos semânticos.

## Noções básicas dos tipos de cálculo DAX

Ao usar DAX (Data Analysis Expressions), você pode adicionar três tipos de cálculo ao seu modelo semântico:

- Tabelas calculadas
- Colunas calculadas
- Medidas

Obs.: O DAX também pode ser usado para criar regras de RLS (segurança em nível de linha), aplicando filtros a tabelas do modelo. Porém, essas regras não são cálculos de modelo e não fazem parte deste módulo.

### Tabelas calculadas

Com DAX, é possível criar tabelas calculadas no modelo, duplicando, transformando ou gerando novos dados. 

Elas são sempre importadas, aumentando o tamanho e o tempo de atualização, e não podem se conectar a fontes externas (para isso usa-se o Power Query). 

São úteis em cenários como:
- Tabelas de datas
- Dimensões de múltipla função
- Análises de teste de hipóteses

### Tabelas de datas

Tabelas de data são essenciais para aplicar inteligência temporal no DAX. Se a origem não tiver uma, é possível criar uma tabela calculada usando CALENDAR ou CALENDARAUTO para que as funções de tempo funcionem corretamente.

### Dimensões com função múltipla

Quando uma tabela atua como dimensão de múltipla função, ela pode ter vários relacionamentos com outra tabela, mas apenas um relacionamento é ativo (linha sólida) e propaga filtros por padrão. Os demais relacionamentos ficam inativos (linhas tracejadas) e só podem ser usados com USERELATIONSHIP em fórmulas.

Uma alternativa de design é criar tabelas de datas separadas (por exemplo, Order Date e Ship Date) para permitir filtros independentes, podendo ser feitas com tabelas calculadas que duplicam a tabela Date.

### Análise de teste de hipóteses

O Power BI permite criar parâmetros de intervalo numérico, que geram tabelas calculadas desconectadas. Elas permitem que usuários selecionem valores (como uma taxa hipotética) que podem ser usados em medidas, mas não propagam filtros para outras tabelas do modelo.

### Colunas calculadas

Colunas calculadas DAX são fórmulas avaliadas linha a linha em uma tabela, retornando um valor por linha. Em modo importação, aumentam o tamanho do modelo e são recalculadas na atualização; em DirectQuery, são avaliadas pelo banco de dados ao consultar a tabela. No painel Dados, colunas calculadas têm um ícone especial.

### Medidas

Medidas DAX são fórmulas que resumem dados e retornam um único valor, **avaliadas no momento da consulta e não armazenadas no modelo**. Aparecem com ícone de calculadora e são chamadas de **medidas explícitas**. Já **medidas implícitas** são colunas resumidas automaticamente em visuais (símbolo ∑), permitindo soma, contagem, mínimo, máximo etc.

## Escrever fórmulas DAX



# Criar elementos visuais e relatórios do Power BI

# Fonte
